<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="21016" />

<meta name="date" content="2021-12-17" />

<title>Homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework</h1>
<h4 class="author">21016</h4>
<h4 class="date">2021-12-17</h4>



<div id="a-21016-2021-09-16" class="section level2">
<h2>A-21016-2021-09-16</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures, tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>text:<br />
datasets包中women数据集记录了15个美国女性的体重和身高数据，尝试对其建立回归模型.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">attach</span>(women)</span>
<span id="cb1-3"><a href="#cb1-3"></a>lm_fit&lt;-<span class="kw">lm</span>(weight<span class="op">~</span>height)</span></code></pre></div>
<p>figures:<br />
画出height和weight的散点图及回归直线.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">plot</span>(height,weight)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">abline</span>(lm_fit,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>画出四副回归模型诊断图.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">plot</span>(lm_fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>tables:<br />
输出women数据集，回归拟合值及残差</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>res&lt;-<span class="kw">data.frame</span>(lm_fit<span class="op">$</span>fitted.values,lm_fit<span class="op">$</span>residuals)</span>
<span id="cb4-2"><a href="#cb4-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>(women)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">height</th>
<th align="right">weight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">58</td>
<td align="right">115</td>
</tr>
<tr class="even">
<td align="right">59</td>
<td align="right">117</td>
</tr>
<tr class="odd">
<td align="right">60</td>
<td align="right">120</td>
</tr>
<tr class="even">
<td align="right">61</td>
<td align="right">123</td>
</tr>
<tr class="odd">
<td align="right">62</td>
<td align="right">126</td>
</tr>
<tr class="even">
<td align="right">63</td>
<td align="right">129</td>
</tr>
<tr class="odd">
<td align="right">64</td>
<td align="right">132</td>
</tr>
<tr class="even">
<td align="right">65</td>
<td align="right">135</td>
</tr>
<tr class="odd">
<td align="right">66</td>
<td align="right">139</td>
</tr>
<tr class="even">
<td align="right">67</td>
<td align="right">142</td>
</tr>
<tr class="odd">
<td align="right">68</td>
<td align="right">146</td>
</tr>
<tr class="even">
<td align="right">69</td>
<td align="right">150</td>
</tr>
<tr class="odd">
<td align="right">70</td>
<td align="right">154</td>
</tr>
<tr class="even">
<td align="right">71</td>
<td align="right">159</td>
</tr>
<tr class="odd">
<td align="right">72</td>
<td align="right">164</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(res)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">lm_fit.fitted.values</th>
<th align="right">lm_fit.residuals</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">112.5833</td>
<td align="right">2.4166667</td>
</tr>
<tr class="even">
<td align="right">116.0333</td>
<td align="right">0.9666667</td>
</tr>
<tr class="odd">
<td align="right">119.4833</td>
<td align="right">0.5166667</td>
</tr>
<tr class="even">
<td align="right">122.9333</td>
<td align="right">0.0666667</td>
</tr>
<tr class="odd">
<td align="right">126.3833</td>
<td align="right">-0.3833333</td>
</tr>
<tr class="even">
<td align="right">129.8333</td>
<td align="right">-0.8333333</td>
</tr>
<tr class="odd">
<td align="right">133.2833</td>
<td align="right">-1.2833333</td>
</tr>
<tr class="even">
<td align="right">136.7333</td>
<td align="right">-1.7333333</td>
</tr>
<tr class="odd">
<td align="right">140.1833</td>
<td align="right">-1.1833333</td>
</tr>
<tr class="even">
<td align="right">143.6333</td>
<td align="right">-1.6333333</td>
</tr>
<tr class="odd">
<td align="right">147.0833</td>
<td align="right">-1.0833333</td>
</tr>
<tr class="even">
<td align="right">150.5333</td>
<td align="right">-0.5333333</td>
</tr>
<tr class="odd">
<td align="right">153.9833</td>
<td align="right">0.0166667</td>
</tr>
<tr class="even">
<td align="right">157.4333</td>
<td align="right">1.5666667</td>
</tr>
<tr class="odd">
<td align="right">160.8833</td>
<td align="right">3.1166667</td>
</tr>
</tbody>
</table>
</div>
<div id="a-21016-2021-09-23" class="section level2">
<h2>A-21016-2021-09-23</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<p>Exercises 3.4, 3.11, and 3.20 (pages 94-96, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p>3.4<br />
The Rayleigh density is<span class="math inline">\(f(x)=\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}},x\geq0,\sigma&gt;0\)</span><br />
The CDF is <span class="math inline">\(F(x)=\int_{0}^{x}f(x)dx=1-e^{-\frac{x^2}{2\sigma^2}}, x\geq0,\sigma&gt;0\)</span><br />
random samples from a Rayleigh(σ) distribution<br />
generate ramdom number<span class="math inline">\(U\sim U(0,1)\)</span><br />
Return<span class="math inline">\(X=F^{-1}(U)=\sqrt{-2\sigma^2log\frac{1}{1-U}}\)</span><br />
example1:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>n&lt;-<span class="fl">1e5</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>sigma&lt;-<span class="dv">5</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>lambda=<span class="kw">sqrt</span>(<span class="dv">2</span>)<span class="op">*</span>sigma</span>
<span id="cb6-4"><a href="#cb6-4"></a>U=<span class="kw">runif</span>(n)</span>
<span id="cb6-5"><a href="#cb6-5"></a>X=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(U))</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="kw">hist</span>(X, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(X)<span class="op">==</span>X<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>X<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))  </span>
<span id="cb6-8"><a href="#cb6-8"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">.01</span>)</span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="kw">lines</span>(y, y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>example2:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>n&lt;-<span class="fl">1e5</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>sigma&lt;-<span class="dv">10</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>lambda=<span class="kw">sqrt</span>(<span class="dv">2</span>)<span class="op">*</span>sigma</span>
<span id="cb7-4"><a href="#cb7-4"></a>U=<span class="kw">runif</span>(n)</span>
<span id="cb7-5"><a href="#cb7-5"></a>X=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(U))</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="kw">hist</span>(X, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(X)<span class="op">==</span>X<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>X<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))  </span>
<span id="cb7-7"><a href="#cb7-7"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="fl">.01</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="kw">lines</span>(y, y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))) </span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>example3:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>n&lt;-<span class="fl">1e5</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>sigma&lt;-<span class="dv">1</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>lambda=<span class="kw">sqrt</span>(<span class="dv">2</span>)<span class="op">*</span>sigma</span>
<span id="cb8-4"><a href="#cb8-4"></a>U=<span class="kw">runif</span>(n)</span>
<span id="cb8-5"><a href="#cb8-5"></a>X=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(U))</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="kw">hist</span>(X, <span class="dt">prob =</span> <span class="ot">TRUE</span>, <span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(X)<span class="op">==</span>X<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>X<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))))  </span>
<span id="cb8-7"><a href="#cb8-7"></a>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">40</span>, <span class="fl">.01</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="kw">lines</span>(y, y<span class="op">/</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))) </span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAsVBMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmOmZmZgBmZmZmkJBmkLZmkNtmtttmtv+QOgCQOjqQZgCQZjqQkDqQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa2kJC227a22/+2/9u2///T09PbkDrbtmbb2//b/7bb////tmb/tpD/25D/27b//7b//9v////fIRNXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALyUlEQVR4nO2dC5vjphWG8WTsZJOmXefW27jXjJJ0uuO0o3pt//8fVkBCAiT4QEIS0p7vSXZmbHEOvIIDSAixO8krtnQGchcBAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQPkAuhwYe5rfDDp+QUCm6+vx6V7unscatczA4kG32QAqH9/ut9PoKmSZgcWDbpcD1ONZnM4E0swEFc/rdgSg2y8/Gn//749vMcl7PJ8fgyzYjt1mGh/eJPx4lfduGYYD+vj9i/XJ5fsPEem7ns8PQem7jp1mlA9vEnm8ynunDPGArt/KsH/97llUzjq+XY/SyxeOElrH9Xs+h4Vo6dhjXDfDjCQfv2Ns91u7itTHq7zbZYgHVHAvzzywvRd/lEwW+HaqukpnG7GO63McWH9qx07jhhmmJxEdOtdnppvmeJV3qwzRgG4naVGdpzPby3+rXF8OndyrfBjH9Ti+fB7WxffVM824YYbpSTi/P/NadGJGFtvjVd6tMgwAJAhfjzVnedpK1vzlqgbmcT2OC3l6YS/WOHYYN8wwPcn1uL+3P7puVd6tMsQCKoW9Pf+h3FwOD/9qA0vhLKJ5nMfvx7/xNiw6k8qHsFg8/Psnxr56ud81xx7jphMziQVIk8q7WYaBgIq2op71E3/uzX/3uMbvr+/kKWyrVh0pFBtZuuLhB/GZaCkF623E597aVzkxk5Tyr45bLe9mGYY1MS3Yit9bgyVzDmWM45TfkjErpwX7Hbf/k+woj3W9KNjun+KzveHYbdzwYSa5HB7f+txqeTfLMAzQ9dg65ae8jZt1h1I37bom9BzXhIcdD5ylNjq7HPaVlyrsvpN+ijrKPnzQHesyjVs+tCSXw+65z62ed/VTNxIhGxA/zX9vkZvGdZnHMZVfWfvP+yardQurzq2qF0VllPdGDkCmcbNsepIz++yl162e98SARAtvW7kbkHlc08KkmctBr4+VhB3uRprrArJqqGncLFubV85bNSLbrZ73FIDadi0jWjOWbdpvp4lZxzU16KkqQ1M2YxRSsN9X0bppYv0xyDJuFq1JcmuGQF23et5TxKDmdPH+9cNdg+7qxazjGq+FzItG5Xba/Yl/9KsIRaXsLp+EN94yZJDu7cXsTFhFU0m07rvjVs97il5MjS14cfQBtfjp6GTM4xqvfBD3cv/4rTb8r9sYP15OrWSvU+zeqVbXMw7qZMIqWp1Eb7xdt1rez6PGQeZIujmfdT12jaTt41qvvF5YE0gxUGRfv6gzLiYQfKDIP/y6Gg93YrFt3C5anaTp2kUWu25TjaSV+qfe7rmYqUivhZblwDm/7iMsSaq5WK1qoGIr8IpXrFMdUL9jr5OwJKlm80qdyzJcl6/CrpiNAdTrGDgJSaLybpdh+BXF219sr+hS32AZgHocQ+EkKu+dMoy5Jv2zdU36H1HXpNM5TpBE5b1bhnxuHGYqAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEFAcoELeDGY9a3E2qyhAks/nz8meGViDYgDJ5SKFvEsZeAt1A4oD9NQsIA9b9b0BxTWxvVi3Jn6jGtQrsWJHVqEET76tRZHdfGmvXd28aBwERICABgIKfHap605pmNsFlCanLLTg7JUf88ru60GUOJ8QEMfz+srSO55MswN6FYBW1Mzicnk7tStpB5mTfF7rf6NcL6WoXDZPVJb9T21Bc8wAtApCMZnUnqd1TTX85pgJaBVxKHayWss1WQWArCa2hjo0Zw1inRi0MUDtYx7DYpANaBV9WVz+rsfuo57B5uToRwck/98WoOHm1EjbApR/VzYboJoHAXJ94QBETUx94QSUOaEZYxAB8pnrhue2s0+bhcRaHlDmo8W5LphVND5ZQNicB1DehAgQ0EyAmBtQ5lOy5QFV/xMgL6CM56zzAGKeGFT9Q4D8gFYQg67HFEsSBgLKeMKhZUzsJBe2N0mQueYj7ULQugHdEzDqA1T1Un5A64lBZ99twXhz920BEsujnuotlBKYqz9SQ521AxIX5OtdzoZXoeGAciWk9WIp1h1uGdA3FZ9xC3xHNLFMCXUADV07ZpnTPtoEoKK95DWkm/ddMNMvRnuDdJ6EOjUokTntozBAuV70mH4uFggo1zl9RoDynNNXWboe36t1CWPG0a6R9PoBTWkuHFCWgyECBKRPNd6LqSqeh5WeRzK3DKh4fBMbyhe+y2Z8uPT+8ps39yOZ3RKyCEBZxyD5JjLxngZPkC7k3s6i9oSvUdwUIPHQrmeqIetN9a6X8FWucYDyI6Q1sb3Ymdr94hK1B/ztP/fpalDOgPhAaPfs33q5qV3Wdvl95poP4ppYdoTiMlTv7V063+DzqQOKNxcJKL8pa5sZ+CRPnLnmgyhA1X8jMpBcWpCOIePq6+yysaiBYtaAnHE3yIrrglk8oNymrMY4KKG59u+tAAp+HUOYOflH5+mDIEC5Bml3390q7pFMpoJKFKDMRov66g7Yi0U+krktQAGKfaBOv+ETASjTGBSg2EcytwaIN7LHt8LT2c9Wg3IipAXp3fNZzOY9hCIfydwWIFE9RL3w3nqOeyRzeBPLiJAxUBSAEi5e6D4BtWZAqgYVo3YnSwQoI0J2DHK8pDDe3H0EoJwuepi92Og9NtMAes3oPv2UF8wwB/cXBAh9kV0Tq3rwsftHbhdQ/Rrb87B15P0XzEYByqyJNVtrWi+IHmiu/mM7gLSrZd5784Hm6t9HAsqDULOASn2QbpXraEBZEFKA4IWMGHP172ObGAFCMSgHQhkDymPGMR0gNrYXkxOOxTszBagdyWQE6DUbQFOYSwEogylZ7oAyiUFTmEsCaPnhYu6AttvErGULwwEtTIgAAa0A0LLDxfwBLTwaSuO554JZSkBLjoYmqUGKViJAi46GpgHUTBTSAFoyUq8D0IKEVgNoKULrAbRQZ78WQIv1ZXE+A1e5OvdGHgNooWYW5TN0les0gJYhNMkq14kALUJoklWuEwKaPVSvqwYtUIsiY1DYKlfn7toJAM2NKM5X4CrXyQHN2NImmqxOCkhRSpt1b4kSm5sB0GwRe6AD/yOZ8wDSKE2IaZILZmwFmhfQhkWAgBJPVrenxJPV7SnxVKM2mrWmAxS8zAoZBd+P+3ps8hGHh9egcU5XCyhgshpmdLOA8GQ1zOh2ASUySoDGfU+ACNC47wnQJw9oSyJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg9IB87yWpdPnCfUtE3pr07lQIN8ny7MJWXTKO2p0kOSCxj0zpLcP16L5ndDvxpGd3EcSqEr91foLcgKp3XkQpNaDq1pBvC5nSd+e62p3HucGK3ITFv7Gz3E/U6Tv+nnlqQKCE8o4RzKa/joBXWzz+1Q3oHL/3T3JA3he3VIKA/Nvrn334uH9PDCq+9Ee4HqUGVJ18fxVAgLy3JUtvCUULdwMSr57hlKIIZQioBN2M71XLIXuJxgWi/JoYXlrjxi+9I0Bx27TNHqTvAFDAPnzuEp7rFS5eAnF9/fzdvB+Qfy/ZCg1oI+4aFJTc0gIDRV8OLwd//RGF11bhOI9xfSVO3LJBOmQy4AFUtxG3gQI1IH8MCkhuiSarQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAAB5Q3ocqjus498f/AY5Q2oXk2F1nxMqcwByfWc/mWtEyt3QNfjfuR7KUcqd0C8ef1h3KtfRyp7QENfHpxK2QO6nZbdcy97QMXjf48LxujsAZV8BLTopoSZA7oc5LpU9IjYhMob0O0k40/1jMUyyhoQD9BVD48e35hQWQPKQQQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAvo/d1/WgokOr0wAAAAASUVORK5CYII=" /><!-- --></p>
<p>3.11</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>n=<span class="dv">1000</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>x1=<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a>x2=<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a>p1=<span class="fl">0.75</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>p2=<span class="dv">1</span><span class="op">-</span>p1</span>
<span id="cb9-6"><a href="#cb9-6"></a>r=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span>T,<span class="dt">prob=</span><span class="kw">c</span>(p1,p2))</span>
<span id="cb9-7"><a href="#cb9-7"></a>z=r<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x2</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw">hist</span>(z,<span class="dt">main=</span><span class="st">&quot;histogram of z with p1=0.75&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#p1=0.3</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>r1=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span>T,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb10-3"><a href="#cb10-3"></a>z1=r1<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r1)<span class="op">*</span>x2</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#p1=0.4</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>r2=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span>T,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>))</span>
<span id="cb10-6"><a href="#cb10-6"></a>z2=r2<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r2)<span class="op">*</span>x2</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#p1=0.5</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>r3=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span>T,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))</span>
<span id="cb10-9"><a href="#cb10-9"></a>z3=r3<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r3)<span class="op">*</span>x2</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#p1=0.6</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>r4=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace=</span>T,<span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.6</span>,<span class="fl">0.4</span>))</span>
<span id="cb10-12"><a href="#cb10-12"></a>z4=r4<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>r4)<span class="op">*</span>x2</span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="kw">hist</span>(z1,<span class="dt">main=</span><span class="st">&quot;histogram of z with p1=0.3&quot;</span>)</span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="kw">hist</span>(z2,<span class="dt">main=</span><span class="st">&quot;histogram of z with p1=0.4&quot;</span>)</span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="kw">hist</span>(z3,<span class="dt">main=</span><span class="st">&quot;histogram of z with p1=0.5&quot;</span>)</span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="kw">hist</span>(z4,<span class="dt">main=</span><span class="st">&quot;histogram of z with p1=0.6&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAw1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYNAAA6AAA6ADo6AGY6OgA6Ojo6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOpBmZjpmkLZmkNtmtttmtv+QOgCQOjqQOmaQZgCQZjqQkGaQtpCQttuQ27aQ2/+2WCG2ZgC2Zjq2kDq2tpC225C227a22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb25Db29vb2//b/7bb/9vb////tmb/25D/27b/29v//7b//9v///8kd6qwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAANyklEQVR4nO2dCXvbNhKGR7Kl1W7SxFq3rqXe9cpJ49ZR0vQQnZr4/79qAZAUKQrA4CIwtvg9TxTCHAxefcRBkTqAjTIKcgNQF+QGoC7IDUBdkBuAuiA3AHVBbgDqgtwA1AW5AagLcgNQF+QGoC4IrP/5EuCVMeJhMb1n/9yu2OMSVrqgDVwEggzFA4FAGwDkuQmgcg1GoI9Yknw8EAxk88zMQOUt+qzy8QB74J3y/Cex/WEBrz7C9P5xOflhMb2TcV/suOWTHy/h/I4Hnt/X1epKvCGAyQ3/A28Nmu2KcsszybqL6W8ibPrrEq5vZUZWVbi6hMnrnUhy9kLUKEQGajxQPcK1yCAlgPh/s91GFuc8qdw4W8iSVFNJA1Tw2mLXSmx96gDVGVlbgZfKb67+Xu+BqPHAEua78k2FMd99Xjdbfz4up3fsAy9yoPmOj8pXO3kQqmR1pYMuXbSNVc/qgu+ed8f87I69aXPM7ngO+RTKdZPmkRgPAzGny+HIe9+NSCpzycFZvv0KJBDfIR+KOtnDvlIXiIPPqu7K/7oq+CGe/SXzHkyKRQu0ah5rIHnEqPGA3C/+UEWK6nzM39RTlRqo2FfqAIlDUPPw0THfwOv19O1CVNcAyUbWR0DUeJRHrNqaXP0hRm8NxONMR4yXps2UyQPOXkxuNvBSThm2R+wwNQ0epp6DBNCWrxHld0ogxZjnKasJsSnxiuIIrBqgi2MgPqfUswg2B+XjYc2qsapXjZedI3bYpTtArK3UANV/aZaVrdiqDqKsyVegyc99IKkLdgB0Q4yHnwf9fnDe0XZpUTx/xzcVQG0lDRCfIFeimXnd//l5yvRdH+j6e5h8zQ6B7ojxdM6kZT/lVu9ntmFleiVEiQfazU2nj+UDosYD7WZ5y89N6z6WD6gVDR5I1P6TFeQGoC4QD2lH+9MS8H+beqHYzLOi0BTw6em/9Snnw3/ujbEnKRgNMgtYO7Q2ic7JUFGaE0E8bAkBMWJzIvjXrBUNpZHnkB+IB2qgwrkHwXup2ED+Bg3DAxVQIXrz1smhwQzynBMHNahci9ch3SMGaI8dziC/OTGxQZ39aYG8NaBBy+n9Vg4xxaqhb68BGmBu9FrmhzNIvtSf3KiHvL69Big+l98yP9ABwxLp9w9mkHIVs58TI/OIROKa/wXznYPSGJSNRyQSXVl0axJAzLzMJ+eB5ogV03sqBpmW+eQ8sO/SxewTFYMMSs4jEtVdetu5V5sPiBGbE0EC1Q4RMYjUnIglSg5EbU7EEiUHojYnYomSAzFicyKWKDkQIzYn6hJlO7VHlJwHS5QciBoPlig5EDUeLFFyIGo8WKLkQNR4sETJgajxYImSA+la81xVgy8wYjVdgYaWK08wHlbTFWhoufKMBiE8o0E6nkajQRqe92q/IjboCOTcsp+sed6rixEbdARybtlP1jxDG5T11bzh1rM1D7keFPGWr+nWszUPOYO8CY4U587qaJAlzzM0KM6t56gGxZwUnQkUinHrOaZBUSdFZwI3OfNEMCjumHcmUIjYMk/OIHLLfNRJ0ZngSHHeYRbToKiTojPBkcZlHtPzXuZjvOJ41st8vI6kbtWTJ8SgQSbF2G9X7vB68UQ3KBsQzpuWR9QgNSm2XzMCQe8PimkQqUlRyPAZhOQ8WI3kQELlWvs5luQ8WI3kQNR4sBrH+/t3nHIbNDAPOE+K6qYzGjQsj6zhNCmeokFOk+LTNsj5/BULDQWyJ/HldeNxxsJCQ4HsSXx5R4OqVrWDYzQoKk80g2IdMXsSX96xB0XlIWdQ7MtCoTzkDIrdkZLzYKHJgajxYKHJgajxYKHJgajxYKHJgajxYKHJgajxYKHJgajxYKHJgex5Dq8kEjAoDZADj6llhMf+BBYLiQTk6sPQPE3RskG7Ny+kOWJpeNwMQt68oL5tMBQQNR7A37wAEWXjDy0enUEZRYsHGL2vSybFA+LB/NWgabs0NR73kIhFP0UE6BUtWrMIiVj0U0SAXtGiNYuQiEU/RQToFS1aswiJWPRTRIBe0aI1i5CIRT9FBOgVLVqzCIlY9FNEgF7RojWLkIhFP0UE6BUtWrMIiVj0U0SAXtGitVF9QW4A6oLcANQFuQGoC3IDUBfkBqAuyA1AXZAbgLogNwB1QW4A6gKLGP3F83Kt+nyHTc0QJeUBi5iNttHN3PwDPPqaIUrKA3hIcabzXdygMR0Ufc0QpeUBNKL89hddWgGzv4vlVDNAiXkAjdheaA8KAmSoGaDEPIAFPH658wQy1fRXah4w7dwCzDcr/bA2A5lq+ikHDyD7689rKn+r3jwpGmt6KzkPWMTofceW1dTnQQPwQBAQPyqkThQH4AHXCqcmyA1AXZAbgLogNwB1QW4A6oLcANQFuQGoC3IDUBfkBqAuyA1AXZAbgLogNwB1QW4A6oLcANQFgfU/XwK8MkY8LKb37J/blbgWob1atdF97iA7DwQCbfSfqegAlWswAn3EkuTjgWAgm2dmBipv0WeVjwfYA++U5z+J7Q8LePURpvePy8kPi+mdjPtixy2f/HgJ53c88Ly5IFdXEr8MDxNxlby+4iu3K0r5U82i7mL6mwib/rqE61uZkVUVri5h8nonkpy9EDUK+fkbYjxQPcL1/kNIAoj/N9tVnxyd86Ry42whS1JNJQ1QwWuLXSux9akDVGdkbQVeKr+5+nu9B6LGA0uY78o3FcZ893ndbP35uJzesQ+8yIHmOz4qX+2a3+9+3Fc66NJF21j1rC747nl3zM/u2Js2x+yO55BPoVw3aR6J8TAQc7ocjrz33YikMpccnOXbr0AC8R3yoaiTPewrdYE4ePMRwQ2sCn6IZ3/JvAeTYtECrZrHGkgeMWo81feTij9UkaI6H/M39VSlBir2lTpA4hA0H6HcwnwDr9fTtwtRXQMkG1kfAVHjUR6xamty9YcYvTUQjzMdsYM7Lg+LsxeTmw28lFOG7RE7TE2Dh6nnIAG05WtE+Z0SSDHmecpJe89XzIizXSFvZNZAF8dAfE6pZxFsDsrHw5pVY1WvGi87R+ywS3eAWFupAar/0iwr4i56fRBlTb4CTX7uA0ldsAOgG2I8/Dzo94PzjrZLi+L5O76pAGoraYD4BLkSzczr/s/PU6bv+kDX38Pka3YIdEeMpzqT3jTZdtzqRB9WN70SagIo8ADbf4Df8JUiCYFa0eCB9qsgyv/9C5o+lg+oVXm7IMAD1L4rg5qAEfuuDGoC8WD+rozTFuQGUCnt9GwWiAdKQMz8DVTJBYwYELVFA7x/X2wwPQ2DOvuTi9SqCsz398WagAF6WuxVNWQ4AAKE5oz+VZIDyO1bCnt1A/cPYlDsVTXUIHE5ScB4zUEDGBR9VQ01SIAIKCIGxV9VAw2qgIrpPWWDrHlUimIQK2af4hkUdMCDVlUlRYQhxlhzwdoW6LBxUP7Vs2OFrKoHwYdfcRswSdcOhfyuqfKvKX8EUo8YbJDf/uEMClpVFYjPzqCgVVWB+NwMCltVFYjP0yDfVVWB+NwM8lxV9YjPziC/VVWP+OwM8uPRI44GIYiDGIS/Vjhxg/D99Aw6OqijQUqittHRICXRaBBCRNSg3tWP2AbZXGCibdB7ddEDyZlHe11sNOiA5LjR0aADktEgHc+RD0djLtQgu1+EU2NRNOi95g8+NKIO8otwuponY5DnfajRIC3QAdYQBjkO+eGHmNeNuuEMch3ygxvkd6NuMIOce/TwBnntPyWDiC3zrkP+9JZ5xyGfZRVzvuQa0yAzr45kXOZ1POMyj/CMyzwzD/lxmUd4Ts0gesu83/4TWuaXzfgOeQteTIPMvDqSIc+k9e/Y1ud8igZZ3BpRNliute/61+d6igZ5UGGx+v3DrWKuQ/7UDHIe8qdnkOOQPz2DHHlGgxCeJ22Q+7rqzvOkDYrdkVSZRoMQHmIGqd8JNBqkwzlVg/QvW0aDkP15DIpzRfEZG6Ti0b4NaDRISTIa1OcZDUJ4RoMQntEghGc0COEZDUJ4RoMQntEghGc0COEZDUJ4RoMQHn+DHG6xYiGd/eqXhnYGRbs23c3gb9A+wK1BZL/RCsQgeyCcB7BX8fENsntPYDqDzDwOzz+SQch7AtUXoQc0CONJbRD2nkCIKBt/aPHoDMooWjzAiH37LiPGA+LB/O27abs0zhMTzNIgp5CIxUD1sx1ldw6waAQPiVgMVD/bUXbnAItG8JCIxUD1sx1ldw6waAQPiVgMVD/bUXbnAItG8JCIxUD1sx1ldw6waAQPiVgMVD/bUXbnAItG8JCIxUD1sx1ldw6waAQPiVgMVD/bUXbnAItGRvUEuQGoC3IDUBfkBqAuyA1AXZAbgLogNwB1QW4A6oLcANQFuQGoCyxi9BfPy7XqY5M2NSPoYQGmH/tFdrc/32EWWJBstCZs5ubfuNLXDNfjcsWKzm/Ku+1m8p7Aw79NAVKAkxRnun4gbtCYOom+ZgQVsx3vBNo+guzu3F0yC9CI8ttfdE9TmGNox1AzkkQ38d1tOfwBjdheaFMhBhlqRtLWfOfMuLuYvUEmKSnAAh6/3HkaZKoZR6of3rDeXfAZ2jxJSYGxBYD5ZqXvjGaDTDUDJcD4o/npIbvRSaoSIPvrr0FQ5zFO0saaMRTUf6qjG8GgJpVa2DI/5BBDlmh8Bd9ciJ+gwpoBGxTt0+S9JNuJ4sbcQZHdrDpRjDBJn7ogNwB1QW4A6vo//qkQVwPygbIAAAAASUVORK5CYII=" /><!-- --></p>
<p>Thus we can see that when p1=0.4,0.5 and 0.6, the histogram of z appears to be bimodal. so we make a conjecture that when p1 gets closer to 0.5,the bimodal mixture is more obvious.</p>
<p>3.20<br />
产生复合泊松-伽马过程随机数：</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>rcompoundpois&lt;-<span class="cf">function</span>(n,lambda,alpha,beta,t){</span>
<span id="cb11-2"><a href="#cb11-2"></a>  X&lt;-<span class="kw">numeric</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb11-4"><a href="#cb11-4"></a>    N&lt;-<span class="kw">rpois</span>(<span class="dv">1</span>,lambda<span class="op">*</span>t)</span>
<span id="cb11-5"><a href="#cb11-5"></a>    Y&lt;-<span class="kw">rgamma</span>(N,alpha,beta)</span>
<span id="cb11-6"><a href="#cb11-6"></a>    X[i]&lt;-<span class="kw">sum</span>(Y)</span>
<span id="cb11-7"><a href="#cb11-7"></a>  }</span>
<span id="cb11-8"><a href="#cb11-8"></a>  <span class="kw">return</span>(X)</span>
<span id="cb11-9"><a href="#cb11-9"></a>}</span></code></pre></div>
<p>example:<br />
分别选取参数的值为<span class="math inline">\(\lambda=1,3,3,5.\alpha=1,2,5,10.\beta=1,2,1,1\)</span> 生成4种复合泊松-伽马过程随机数，得到其模拟均值和方差和理论期望方差的值为：</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>n=<span class="fl">1e5</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>t=<span class="dv">10</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>lambda=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>alpha=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>beta=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>X1=<span class="kw">rcompoundpois</span>(n,lambda[<span class="dv">1</span>],alpha[<span class="dv">1</span>],beta[<span class="dv">1</span>],t)</span>
<span id="cb12-7"><a href="#cb12-7"></a>X2=<span class="kw">rcompoundpois</span>(n,lambda[<span class="dv">2</span>],alpha[<span class="dv">2</span>],beta[<span class="dv">2</span>],t)</span>
<span id="cb12-8"><a href="#cb12-8"></a>X3=<span class="kw">rcompoundpois</span>(n,lambda[<span class="dv">3</span>],alpha[<span class="dv">3</span>],beta[<span class="dv">3</span>],t)</span>
<span id="cb12-9"><a href="#cb12-9"></a>X4=<span class="kw">rcompoundpois</span>(n,lambda[<span class="dv">4</span>],alpha[<span class="dv">4</span>],beta[<span class="dv">4</span>],t)</span>
<span id="cb12-10"><a href="#cb12-10"></a>mean=<span class="kw">c</span>(<span class="kw">mean</span>(X1),<span class="kw">mean</span>(X2),<span class="kw">mean</span>(X3),<span class="kw">mean</span>(X4))</span>
<span id="cb12-11"><a href="#cb12-11"></a>sd2=<span class="kw">c</span>(<span class="kw">sd</span>(X1)<span class="op">^</span><span class="dv">2</span>,<span class="kw">sd</span>(X2)<span class="op">^</span><span class="dv">2</span>,<span class="kw">sd</span>(X3)<span class="op">^</span><span class="dv">2</span>,<span class="kw">sd</span>(X4)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a>u=<span class="kw">c</span>(lambda<span class="op">*</span>t<span class="op">*</span>alpha<span class="op">/</span>beta)</span>
<span id="cb12-13"><a href="#cb12-13"></a>sigma2=lambda<span class="op">*</span>t<span class="op">*</span>alpha<span class="op">*</span>(alpha<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(beta<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb12-14"><a href="#cb12-14"></a>para=<span class="kw">data.frame</span>(mean,u,sigma2,sd2)</span>
<span id="cb12-15"><a href="#cb12-15"></a>knitr<span class="op">::</span><span class="kw">kable</span>(para)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">mean</th>
<th align="right">u</th>
<th align="right">sigma2</th>
<th align="right">sd2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">9.998641</td>
<td align="right">10</td>
<td align="right">20</td>
<td align="right">19.92133</td>
</tr>
<tr class="even">
<td align="right">29.965019</td>
<td align="right">30</td>
<td align="right">45</td>
<td align="right">45.00374</td>
</tr>
<tr class="odd">
<td align="right">150.022034</td>
<td align="right">150</td>
<td align="right">900</td>
<td align="right">894.86744</td>
</tr>
<tr class="even">
<td align="right">500.323783</td>
<td align="right">500</td>
<td align="right">5500</td>
<td align="right">5517.14257</td>
</tr>
</tbody>
</table>
<p>从表中可以看出，模拟的复合泊松-伽马过程随机数的均值与方差和理论结果十分相近。</p>
</div>
<div id="a-21016-2021-09-30" class="section level2">
<h2>A-21016-2021-09-30</h2>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.4,5.9,5.13 and 5.14.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
</div>
<div id="section" class="section level2">
<h2>5.4</h2>
<p><span class="math inline">\(\alpha=3,\beta=3\)</span>,the probability density function of beta(3,3) is <span class="math display">\[f(x)=\frac{\Gamma(6)}{\Gamma(3)^2}x^2(1-x)^2=30x^2(1-x)^2\]</span><br />
the CDF is <span class="math inline">\(F(x)=\int_{0}^{x}30x^2(1-x)^2dx, 0&lt;x&lt;1\)</span><br />
<span class="math inline">\(g(X)=30X^3(1-X)^2,X\sim U(0,x)\)</span><br />
<span class="math inline">\(F(x)=E(g(X))\)</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>beta.hat&lt;-<span class="cf">function</span>(x){</span>
<span id="cb13-2"><a href="#cb13-2"></a>  n&lt;-<span class="fl">1e4</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>  X&lt;-<span class="kw">runif</span>(n,<span class="dv">0</span>,x)</span>
<span id="cb13-4"><a href="#cb13-4"></a>  g&lt;-<span class="dv">30</span><span class="op">*</span>X<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>X)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>x</span>
<span id="cb13-5"><a href="#cb13-5"></a>  F&lt;-<span class="kw">mean</span>(g)</span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="kw">return</span>(F)</span>
<span id="cb13-7"><a href="#cb13-7"></a>}</span>
<span id="cb13-8"><a href="#cb13-8"></a>F.hat=<span class="kw">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb13-9"><a href="#cb13-9"></a>x=<span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>)</span>
<span id="cb13-10"><a href="#cb13-10"></a>F=<span class="kw">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>){</span>
<span id="cb13-12"><a href="#cb13-12"></a>  F.hat[i]=<span class="kw">beta.hat</span>(x[i])</span>
<span id="cb13-13"><a href="#cb13-13"></a>}</span>
<span id="cb13-14"><a href="#cb13-14"></a>CDF&lt;-<span class="kw">data.frame</span>(F,F.hat)</span>
<span id="cb13-15"><a href="#cb13-15"></a>knitr<span class="op">::</span><span class="kw">kable</span>(CDF)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">F</th>
<th align="right">F.hat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.00856</td>
<td align="right">0.0083877</td>
</tr>
<tr class="even">
<td align="right">0.05792</td>
<td align="right">0.0579751</td>
</tr>
<tr class="odd">
<td align="right">0.16308</td>
<td align="right">0.1614667</td>
</tr>
<tr class="even">
<td align="right">0.31744</td>
<td align="right">0.3157134</td>
</tr>
<tr class="odd">
<td align="right">0.50000</td>
<td align="right">0.5046964</td>
</tr>
<tr class="even">
<td align="right">0.68256</td>
<td align="right">0.6806838</td>
</tr>
<tr class="odd">
<td align="right">0.83692</td>
<td align="right">0.8386516</td>
</tr>
<tr class="even">
<td align="right">0.94208</td>
<td align="right">0.9359443</td>
</tr>
<tr class="odd">
<td align="right">0.99144</td>
<td align="right">0.9923547</td>
</tr>
</tbody>
</table>
</div>
<div id="section-1" class="section level2">
<h2>5.9</h2>
<p>Choose inverse transformation method to generate random samples from a Rayleigh distribution with <span class="math inline">\(\sigma=1\)</span>.<br />
The antithetic variables:<br />
<span class="math inline">\(X=F^{-1}(U)=\sqrt{-2\sigma^2log(U)}\)</span><br />
<span class="math inline">\(X&#39;=F^{-1}(1-U)=\sqrt{-2\sigma^2log(1-U)}\)</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>n=<span class="fl">1e4</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>sigma=<span class="dv">1</span></span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a>U_<span class="dv">1</span>=<span class="kw">runif</span>(n)</span>
<span id="cb14-5"><a href="#cb14-5"></a>X=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(U_<span class="dv">1</span>))</span>
<span id="cb14-6"><a href="#cb14-6"></a>Xx=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>U_<span class="dv">1</span>))</span>
<span id="cb14-7"><a href="#cb14-7"></a>U_<span class="dv">2</span>=<span class="kw">runif</span>(n)</span>
<span id="cb14-8"><a href="#cb14-8"></a>X_<span class="dv">1</span>=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(U_<span class="dv">2</span>))</span>
<span id="cb14-9"><a href="#cb14-9"></a>U_<span class="dv">3</span>=<span class="kw">runif</span>(n)</span>
<span id="cb14-10"><a href="#cb14-10"></a>X_<span class="dv">2</span>=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(U_<span class="dv">3</span>))</span>
<span id="cb14-11"><a href="#cb14-11"></a></span>
<span id="cb14-12"><a href="#cb14-12"></a>var1=<span class="kw">sd</span>((X<span class="op">+</span>Xx)<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb14-13"><a href="#cb14-13"></a>var2=<span class="kw">sd</span>((X_<span class="dv">1</span><span class="op">+</span>X_<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>var&lt;-<span class="kw">data.frame</span>(var1,var2)</span>
<span id="cb14-15"><a href="#cb14-15"></a>knitr<span class="op">::</span><span class="kw">kable</span>(var)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">var1</th>
<th align="right">var2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.010512</td>
<td align="right">0.2145899</td>
</tr>
</tbody>
</table>
<p>the variance of <span class="math inline">\(\frac{X+X&#39;}{2}\)</span> is <code>var1</code>,the variance of <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> is <code>var2</code>, the former is smaller.</p>
</div>
<div id="section-2" class="section level2">
<h2>5.13</h2>
<p><span class="math inline">\(X_1\sim N(0,1)\)</span><br />
<span class="math display">\[f_1(x)=\frac{1}{2\pi}e^{-\frac{x^2}{2}},-\infty&lt;x&lt;+\infty\]</span> <span class="math inline">\(X_2\sim Rayleigh(\sigma=1)\)</span><br />
<span class="math display">\[f_2(x)=xe^\frac{x^2}{2},x\ge0\]</span> <span class="math display">\[\hat{\theta}=\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx=E[X_1^2I(X_1&gt;1)]=E[\frac{X_2}{\sqrt{2\pi}}I(X_2&gt;1)]\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>n=<span class="fl">1e4</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>X_<span class="dv">1</span>=<span class="kw">rnorm</span>(n)</span>
<span id="cb15-3"><a href="#cb15-3"></a>X_<span class="dv">1</span>[X_<span class="dv">1</span><span class="op">&lt;</span><span class="dv">1</span>]=<span class="dv">0</span></span>
<span id="cb15-4"><a href="#cb15-4"></a>theta.hat1=<span class="kw">mean</span>(X_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a>U=<span class="kw">runif</span>(n)</span>
<span id="cb15-7"><a href="#cb15-7"></a>X_<span class="dv">2</span>=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(U)) </span>
<span id="cb15-8"><a href="#cb15-8"></a>X_<span class="dv">2</span>[X_<span class="dv">2</span><span class="op">&lt;</span><span class="dv">1</span>]=<span class="dv">0</span></span>
<span id="cb15-9"><a href="#cb15-9"></a>theta.hat2=<span class="kw">mean</span>(X_<span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb15-10"><a href="#cb15-10"></a>var1&lt;-<span class="kw">sd</span>(X_<span class="dv">1</span><span class="op">^</span><span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>var2&lt;-<span class="kw">sd</span>(X_<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))<span class="op">^</span><span class="dv">2</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>f&lt;-<span class="cf">function</span>(x){</span>
<span id="cb15-13"><a href="#cb15-13"></a>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)}</span>
<span id="cb15-14"><a href="#cb15-14"></a>theta&lt;-<span class="kw">integrate</span>(f,<span class="dv">1</span>,<span class="ot">Inf</span>)<span class="op">$</span>value</span>
<span id="cb15-15"><a href="#cb15-15"></a>f1&lt;-<span class="kw">c</span>(theta.hat1,var1)</span>
<span id="cb15-16"><a href="#cb15-16"></a>f2&lt;-<span class="kw">c</span>(theta.hat2,var2)</span>
<span id="cb15-17"><a href="#cb15-17"></a>theta.hat&lt;-<span class="kw">data.frame</span>(<span class="dt">f1=</span>f1,<span class="dt">f2=</span>f2)</span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="kw">row.names</span>(theta.hat)&lt;-<span class="kw">c</span>(<span class="st">&quot;est&quot;</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb15-19"><a href="#cb15-19"></a>knitr<span class="op">::</span><span class="kw">kable</span>(theta.hat)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">f1</th>
<th align="right">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">est</td>
<td align="right">0.4051211</td>
<td align="right">0.4071990</td>
</tr>
<tr class="even">
<td align="left">var</td>
<td align="right">1.3001657</td>
<td align="right">0.1289269</td>
</tr>
</tbody>
</table>
<p>f2 can produce the smaller variance</p>
</div>
<div id="section-3" class="section level2">
<h2>5.14</h2>
<p>According to the result of 5.13, we can choose the f2 importance function to estimate the integrate.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>n=<span class="fl">1e4</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>U=<span class="kw">runif</span>(n)</span>
<span id="cb16-3"><a href="#cb16-3"></a>X_<span class="dv">2</span>=<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(U)) </span>
<span id="cb16-4"><a href="#cb16-4"></a>X_<span class="dv">2</span>[X_<span class="dv">2</span><span class="op">&lt;</span><span class="dv">1</span>]=<span class="dv">0</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>theta.hat=<span class="kw">mean</span>(X_<span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a>f&lt;-<span class="cf">function</span>(x){</span>
<span id="cb16-8"><a href="#cb16-8"></a>x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)}</span>
<span id="cb16-9"><a href="#cb16-9"></a>theta&lt;-<span class="kw">integrate</span>(f,<span class="dv">1</span>,<span class="ot">Inf</span>)<span class="op">$</span>value</span>
<span id="cb16-10"><a href="#cb16-10"></a></span>
<span id="cb16-11"><a href="#cb16-11"></a>result&lt;-<span class="kw">data.frame</span>(<span class="dt">theta.hat=</span>theta.hat,<span class="dt">theta=</span>theta)</span>
<span id="cb16-12"><a href="#cb16-12"></a>knitr<span class="op">::</span><span class="kw">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">theta.hat</th>
<th align="right">theta</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.4007789</td>
<td align="right">0.400626</td>
</tr>
</tbody>
</table>
</div>
<div id="a-21016-2021-10-14" class="section level2">
<h2>A-21016-2021-10-14</h2>
</div>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).<br />
6.5 Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use aMonte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(χ2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)<br />
//</p>
<p>6.A Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(χ2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential( rate=1). In each case, test <span class="math inline">\(H0 : μ = μ_0 vs H1 : μ \neq μ_0\)</span>, where μ0 is the mean of χ2(1), Uniform(0,2), and Exponential(1), respectively.</p>
<p>I If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level. I What is the corresponding hypothesis test problem? I What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why? I Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
</div>
<div id="section-4" class="section level2">
<h2>6.5</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#norm mean=2,sd=3</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>n=<span class="dv">20</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>m=<span class="fl">1e4</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>U=V=y=<span class="kw">numeric</span>(m)</span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb17-8"><a href="#cb17-8"></a> X=<span class="kw">rnorm</span>(n,<span class="dv">2</span>,<span class="dt">sd=</span><span class="dv">3</span>) </span>
<span id="cb17-9"><a href="#cb17-9"></a> U[i]&lt;-<span class="kw">mean</span>(X)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb17-10"><a href="#cb17-10"></a> V[i]&lt;-<span class="kw">mean</span>(X)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb17-11"><a href="#cb17-11"></a> <span class="cf">if</span>(U[i]<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;&amp;</span>V[i]<span class="op">&gt;</span><span class="dv">2</span>) y[i]=<span class="dv">1</span> </span>
<span id="cb17-12"><a href="#cb17-12"></a> <span class="cf">else</span> y[i]=<span class="dv">0</span></span>
<span id="cb17-13"><a href="#cb17-13"></a>}</span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.953</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">#chisq</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="kw">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb19-3"><a href="#cb19-3"></a>n=<span class="dv">20</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>m=<span class="fl">1e4</span></span>
<span id="cb19-5"><a href="#cb19-5"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb19-6"><a href="#cb19-6"></a>U=V=y=<span class="kw">numeric</span>(m)</span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb19-8"><a href="#cb19-8"></a> X=<span class="kw">rchisq</span>(n,<span class="dv">2</span>) </span>
<span id="cb19-9"><a href="#cb19-9"></a> U[i]&lt;-<span class="kw">mean</span>(X)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb19-10"><a href="#cb19-10"></a> V[i]&lt;-<span class="kw">mean</span>(X)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n)</span>
<span id="cb19-11"><a href="#cb19-11"></a> <span class="cf">if</span>(U[i]<span class="op">&lt;</span><span class="dv">2</span><span class="op">&amp;&amp;</span>V[i]<span class="op">&gt;</span><span class="dv">2</span>) y[i]=<span class="dv">1</span> </span>
<span id="cb19-12"><a href="#cb19-12"></a> <span class="cf">else</span> y[i]=<span class="dv">0</span></span>
<span id="cb19-13"><a href="#cb19-13"></a>}</span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.9164</code></pre>
<p>estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(χ2(2)\)</span> data is 95.32%.<br />
estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(χ2(2)\)</span> data is 91.64%.<br />
Now compare the t-interval results with the simulation results in Example 6.4.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#normal</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb21-5"><a href="#cb21-5"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb21-6"><a href="#cb21-6"></a>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb21-7"><a href="#cb21-7"></a>} )</span>
<span id="cb21-8"><a href="#cb21-8"></a><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.938</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">#chisq</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">.05</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb23-5"><a href="#cb23-5"></a>x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb23-6"><a href="#cb23-6"></a>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb23-7"><a href="#cb23-7"></a>} )</span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.78</code></pre>
<p>we can see the t-interval should be more robust to departures from normality than the interval for variance.</p>
</div>
<div id="a" class="section level2">
<h2>6.A</h2>
<p>case 1 chisquare(1)</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">#n=20</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>n=<span class="dv">20</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>m=<span class="fl">1e4</span></span>
<span id="cb25-4"><a href="#cb25-4"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>U=V=y=p=<span class="kw">numeric</span>(m)</span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb25-7"><a href="#cb25-7"></a> X=<span class="kw">rchisq</span>(n,<span class="dv">1</span>) </span>
<span id="cb25-8"><a href="#cb25-8"></a> T[i]=<span class="kw">abs</span>((<span class="kw">mean</span>(X)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sqrt</span>(n)<span class="op">/</span><span class="kw">sd</span>(X))</span>
<span id="cb25-9"><a href="#cb25-9"></a> p[i]=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(T[i],n<span class="dv">-1</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb25-10"><a href="#cb25-10"></a> <span class="cf">if</span>(p[i]<span class="op">&lt;</span>alpha) y[i]=<span class="dv">1</span> </span>
<span id="cb25-11"><a href="#cb25-11"></a> <span class="cf">else</span> y[i]=<span class="dv">0</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>}</span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="co">#the result is mean(y)</span></span>
<span id="cb25-14"><a href="#cb25-14"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.1072</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">#n=200</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>n=<span class="dv">200</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>m=<span class="fl">1e4</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>U=V=y=p=<span class="kw">numeric</span>(m)</span>
<span id="cb27-6"><a href="#cb27-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb27-7"><a href="#cb27-7"></a> X=<span class="kw">rchisq</span>(n,<span class="dv">1</span>) </span>
<span id="cb27-8"><a href="#cb27-8"></a> T[i]=<span class="kw">abs</span>((<span class="kw">mean</span>(X)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sqrt</span>(n)<span class="op">/</span><span class="kw">sd</span>(X))</span>
<span id="cb27-9"><a href="#cb27-9"></a> p[i]=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(T[i],n<span class="dv">-1</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb27-10"><a href="#cb27-10"></a> <span class="cf">if</span>(p[i]<span class="op">&lt;</span>alpha) y[i]=<span class="dv">1</span> </span>
<span id="cb27-11"><a href="#cb27-11"></a> <span class="cf">else</span> y[i]=<span class="dv">0</span></span>
<span id="cb27-12"><a href="#cb27-12"></a>}</span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.0534</code></pre>
<p>case2 Uniform(0,2)</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co">#n=20</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>n=<span class="dv">20</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>m=<span class="fl">1e4</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>U=V=y=p=<span class="kw">numeric</span>(m)</span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb29-7"><a href="#cb29-7"></a> X=<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb29-8"><a href="#cb29-8"></a> T[i]=<span class="kw">abs</span>((<span class="kw">mean</span>(X)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sqrt</span>(n)<span class="op">/</span><span class="kw">sd</span>(X))</span>
<span id="cb29-9"><a href="#cb29-9"></a> p[i]=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(T[i],n<span class="dv">-1</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb29-10"><a href="#cb29-10"></a> <span class="cf">if</span>(p[i]<span class="op">&lt;</span>alpha) y[i]=<span class="dv">1</span> </span>
<span id="cb29-11"><a href="#cb29-11"></a> <span class="cf">else</span> y[i]=<span class="dv">0</span></span>
<span id="cb29-12"><a href="#cb29-12"></a>}</span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.0508</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co">#n=200</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>n=<span class="dv">200</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>m=<span class="fl">1e4</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>U=V=y=p=<span class="kw">numeric</span>(m)</span>
<span id="cb31-6"><a href="#cb31-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb31-7"><a href="#cb31-7"></a> X=<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb31-8"><a href="#cb31-8"></a> T[i]=<span class="kw">abs</span>((<span class="kw">mean</span>(X)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sqrt</span>(n)<span class="op">/</span><span class="kw">sd</span>(X))</span>
<span id="cb31-9"><a href="#cb31-9"></a> p[i]=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(T[i],n<span class="dv">-1</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb31-10"><a href="#cb31-10"></a> <span class="cf">if</span>(p[i]<span class="op">&lt;</span>alpha) y[i]=<span class="dv">1</span> </span>
<span id="cb31-11"><a href="#cb31-11"></a> <span class="cf">else</span> y[i]=<span class="dv">0</span></span>
<span id="cb31-12"><a href="#cb31-12"></a>}</span>
<span id="cb31-13"><a href="#cb31-13"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.0515</code></pre>
<p>case3 Exponential(rate=1)</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">#n=20</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>n=<span class="dv">20</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>m=<span class="fl">1e4</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb33-5"><a href="#cb33-5"></a>U=V=y=p=<span class="kw">numeric</span>(m)</span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb33-7"><a href="#cb33-7"></a> X=<span class="kw">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb33-8"><a href="#cb33-8"></a> T[i]=<span class="kw">abs</span>((<span class="kw">mean</span>(X)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sqrt</span>(n)<span class="op">/</span><span class="kw">sd</span>(X))</span>
<span id="cb33-9"><a href="#cb33-9"></a> p[i]=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(T[i],n<span class="dv">-1</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb33-10"><a href="#cb33-10"></a> <span class="cf">if</span>(p[i]<span class="op">&lt;</span>alpha) y[i]=<span class="dv">1</span> </span>
<span id="cb33-11"><a href="#cb33-11"></a> <span class="cf">else</span> y[i]=<span class="dv">0</span></span>
<span id="cb33-12"><a href="#cb33-12"></a>}</span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.0783</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co">#n=200</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>n=<span class="dv">200</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>m=<span class="fl">1e4</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb35-5"><a href="#cb35-5"></a>U=V=y=p=<span class="kw">numeric</span>(m)</span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb35-7"><a href="#cb35-7"></a> X=<span class="kw">rexp</span>(n,<span class="dv">1</span>)</span>
<span id="cb35-8"><a href="#cb35-8"></a> T[i]=<span class="kw">abs</span>((<span class="kw">mean</span>(X)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="kw">sqrt</span>(n)<span class="op">/</span><span class="kw">sd</span>(X))</span>
<span id="cb35-9"><a href="#cb35-9"></a> p[i]=<span class="dv">2</span><span class="op">*</span><span class="kw">pt</span>(T[i],n<span class="dv">-1</span>,<span class="dt">lower.tail =</span> F)</span>
<span id="cb35-10"><a href="#cb35-10"></a> <span class="cf">if</span>(p[i]<span class="op">&lt;</span>alpha) y[i]=<span class="dv">1</span> </span>
<span id="cb35-11"><a href="#cb35-11"></a> <span class="cf">else</span> y[i]=<span class="dv">0</span></span>
<span id="cb35-12"><a href="#cb35-12"></a>}</span>
<span id="cb35-13"><a href="#cb35-13"></a><span class="kw">mean</span>(y)</span></code></pre></div>
<pre><code>## [1] 0.0558</code></pre>
<p>Discuss: the uniform case is more equal to the nominal significance level <span class="math inline">\(\alpha\)</span> than the other two cases. Then is the exponential case, and the chisquare is less equal to the nominal significance level <span class="math inline">\(\alpha\)</span> than others. So the t-test is the most robust to uniform distribution.<br />
When size n is larger, the result is closer to <span class="math inline">\(\alpha\)</span> in case 1 2and 3.</p>
</div>
<div id="section-5" class="section level2">
<h2>3</h2>
<p>(1)<span class="math display">\[H_0:\overline{power}_1=\overline{power}_2 \ vs\ H_1:\overline{power}_1\neq \overline{power}_2\]</span> 其中 <span class="math inline">\(\overline{power}_1=\frac{1}{n}\sum_{i=1}^npower_1[i]\)</span><br />
<span class="math inline">\(\overline{power}_2=\frac{1}{n}\sum_{i=1}^npower_2[i]\)</span><br />
(2)使用配对t检验(paired t-test).令<span class="math inline">\(d[i]=power_1[i]-power_2[i]\)</span>,则<span class="math inline">\(H_0: \bar{d}=0,\ H_1:\bar{d}\neq 0\)</span>. <span class="math inline">\(d[i]\)</span>相互独立同分布，且存在期望和方差。假设d服从正态分布，<span class="math inline">\(H_0\)</span>为真时，<span class="math inline">\(\frac{\sqrt{n}\bar{d}}{sd(d)}\sim t_{n-1}\)</span>，因此当|<span class="math inline">\(\frac{\sqrt{n}\bar{d}}{sd(d)}|&gt;t_{\alpha/2}\)</span>时，拒绝<span class="math inline">\(H_0\)</span>,，接受<span class="math inline">\(H_1\)</span>, 当|<span class="math inline">\(\frac{\sqrt{n}\bar{d}}{sd(d)}|\leq t_{\alpha/2}\)</span>时，拒绝<span class="math inline">\(H_1\)</span>,，接受<span class="math inline">\(H_0\)</span>.<br />
(3)需要假设d服从正态分布，得到<span class="math inline">\(power_1,power_2\)</span>的每个具体数据，样本量n和<span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="a-21016-2021-10-21" class="section level2">
<h2>A-21016-2021-10-21</h2>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R). Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<p>Example6.8<br />
Assume <span class="math inline">\(X\sim N(\mathbf{\mu},\Sigma)\)</span>, where <span class="math display">\[\begin{aligned}
\mu=\left(
    \begin{array}
  0  
    0 \\
    0\\
    0
    \end{array}
    \right)
\end{aligned}
\quad
\Sigma=\left(
\begin{array}
{ccc}
  1\ \ 0\ \ 0\\
    0\ \ 1\ \ 0 \\
    0\ \ 0\ \ 1  \\
    \end{array}
\right)\]</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb37-4"><a href="#cb37-4"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>  xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x)</span>
<span id="cb37-6"><a href="#cb37-6"></a>  xbarm&lt;-<span class="kw">matrix</span>(<span class="kw">rep</span>(xbar,<span class="kw">nrow</span>(x)),<span class="kw">nrow</span>(x),<span class="kw">ncol</span>(x),<span class="dt">byrow =</span> T)</span>
<span id="cb37-7"><a href="#cb37-7"></a>  sigmabar&lt;-<span class="kw">t</span>(x<span class="op">-</span>xbarm)<span class="op">%*%</span>(x<span class="op">-</span>xbarm)<span class="op">/</span><span class="kw">nrow</span>(x)</span>
<span id="cb37-8"><a href="#cb37-8"></a>  a &lt;-<span class="st"> </span>(x<span class="op">-</span>xbarm)<span class="op">%*%</span><span class="kw">solve</span>(sigmabar)<span class="op">%*%</span><span class="kw">t</span>(x<span class="op">-</span>xbarm)</span>
<span id="cb37-9"><a href="#cb37-9"></a>  b&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>(a<span class="op">^</span><span class="dv">3</span>))<span class="op">/</span>(<span class="kw">nrow</span>(x)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb37-10"><a href="#cb37-10"></a>  <span class="kw">return</span>( b )</span>
<span id="cb37-11"><a href="#cb37-11"></a>}</span>
<span id="cb37-12"><a href="#cb37-12"></a></span>
<span id="cb37-13"><a href="#cb37-13"></a>alpha=<span class="fl">0.05</span></span>
<span id="cb37-14"><a href="#cb37-14"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>);m &lt;-<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb37-15"><a href="#cb37-15"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.95</span>,<span class="dv">10</span>)</span>
<span id="cb37-16"><a href="#cb37-16"></a>mu=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb37-17"><a href="#cb37-17"></a>sigma=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb37-18"><a href="#cb37-18"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) <span class="co">#to store sim. results</span></span>
<span id="cb37-19"><a href="#cb37-19"></a></span>
<span id="cb37-20"><a href="#cb37-20"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</span>
<span id="cb37-21"><a href="#cb37-21"></a>  </span>
<span id="cb37-22"><a href="#cb37-22"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </span>
<span id="cb37-23"><a href="#cb37-23"></a>  </span>
<span id="cb37-24"><a href="#cb37-24"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb37-25"><a href="#cb37-25"></a>    x&lt;-<span class="kw">mvrnorm</span>(n[i],mu,sigma)</span>
<span id="cb37-26"><a href="#cb37-26"></a>    b=<span class="kw">sk</span>(x)</span>
<span id="cb37-27"><a href="#cb37-27"></a>    sktests[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n[i]<span class="op">*</span>b<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv )</span>
<span id="cb37-28"><a href="#cb37-28"></a>  }</span>
<span id="cb37-29"><a href="#cb37-29"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) </span>
<span id="cb37-30"><a href="#cb37-30"></a>}</span>
<span id="cb37-31"><a href="#cb37-31"></a>p.reject</span></code></pre></div>
<pre><code>## [1] 0.0006 0.0197 0.0355 0.0422 0.0503 0.0493</code></pre>
<p>The result p.reject shows that when n&gt;50, the t1e is close to 0.05.<br />
Example 6.10<br />
Assume <span class="math inline">\(X\sim (1-\epsilon)N(\mathbf{\mu},\Sigma_1)+\epsilon N(\mu,\Sigma_2),0\leq \epsilon \leq 1\)</span>, where <span class="math display">\[\begin{aligned}
\mu=\left(
    \begin{array}
  0  
    0 \\
    0\\
    0
    \end{array}
    \right)
\end{aligned}
\quad 
\Sigma_1=\left(
\begin{array}
{ccc}
  1\ \ 0\ \ 0\\
    0\ \ 1\ \ 0 \\
    0\ \ 0\ \ 1  \\
    \end{array}
\right)
\quad 
\Sigma_2=\left(
\begin{array}
{ccc}
  100\ \ 0\ \ 0\\
    0\ \ 100\ \ 0 \\
    0\ \ 0\ \ 100  \\
    \end{array}
\right)\]</span></p>
<p>From the result of 6.8, we choose n=50.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">library</span>(MASS)</span>
<span id="cb39-2"><a href="#cb39-2"></a></span>
<span id="cb39-3"><a href="#cb39-3"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb39-4"><a href="#cb39-4"></a>  <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>  xbar &lt;-<span class="st"> </span><span class="kw">colMeans</span>(x)</span>
<span id="cb39-6"><a href="#cb39-6"></a>  xbarm&lt;-<span class="kw">matrix</span>(<span class="kw">rep</span>(xbar,<span class="kw">nrow</span>(x)),<span class="kw">nrow</span>(x),<span class="kw">ncol</span>(x),<span class="dt">byrow =</span> T)</span>
<span id="cb39-7"><a href="#cb39-7"></a>  sigmabar&lt;-<span class="kw">t</span>(x<span class="op">-</span>xbarm)<span class="op">%*%</span>(x<span class="op">-</span>xbarm)<span class="op">/</span><span class="kw">nrow</span>(x)</span>
<span id="cb39-8"><a href="#cb39-8"></a>  a &lt;-<span class="st"> </span>(x<span class="op">-</span>xbarm)<span class="op">%*%</span><span class="kw">solve</span>(sigmabar)<span class="op">%*%</span><span class="kw">t</span>(x<span class="op">-</span>xbarm)</span>
<span id="cb39-9"><a href="#cb39-9"></a>  b&lt;-<span class="kw">sum</span>(<span class="kw">colSums</span>(a<span class="op">^</span><span class="dv">3</span>))<span class="op">/</span>(<span class="kw">nrow</span>(x)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="kw">return</span>( b )</span>
<span id="cb39-11"><a href="#cb39-11"></a>}</span>
<span id="cb39-12"><a href="#cb39-12"></a>alpha &lt;-<span class="st"> </span><span class="fl">.1</span></span>
<span id="cb39-13"><a href="#cb39-13"></a>n &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb39-14"><a href="#cb39-14"></a>m &lt;-<span class="st"> </span><span class="dv">2500</span></span>
<span id="cb39-15"><a href="#cb39-15"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb39-16"><a href="#cb39-16"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb39-17"><a href="#cb39-17"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb39-18"><a href="#cb39-18"></a>mu=<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb39-19"><a href="#cb39-19"></a>sigma1=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb39-20"><a href="#cb39-20"></a>sigma2=<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb39-21"><a href="#cb39-21"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb39-22"><a href="#cb39-22"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha,<span class="dv">10</span>)</span>
<span id="cb39-23"><a href="#cb39-23"></a></span>
<span id="cb39-24"><a href="#cb39-24"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb39-25"><a href="#cb39-25"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb39-26"><a href="#cb39-26"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb39-27"><a href="#cb39-27"></a>  </span>
<span id="cb39-28"><a href="#cb39-28"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></span>
<span id="cb39-29"><a href="#cb39-29"></a>    index &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb39-30"><a href="#cb39-30"></a>    x1 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, mu, sigma1)</span>
<span id="cb39-31"><a href="#cb39-31"></a>    x2 &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n, mu, sigma2)</span>
<span id="cb39-32"><a href="#cb39-32"></a>    x&lt;-(<span class="dv">1</span><span class="op">-</span>index)<span class="op">*</span>x1<span class="op">+</span>index<span class="op">*</span>x2</span>
<span id="cb39-33"><a href="#cb39-33"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(n<span class="op">*</span><span class="kw">sk</span>(x)<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb39-34"><a href="#cb39-34"></a>  }</span>
<span id="cb39-35"><a href="#cb39-35"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb39-36"><a href="#cb39-36"></a>}</span>
<span id="cb39-37"><a href="#cb39-37"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb39-38"><a href="#cb39-38"></a>     <span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb39-39"><a href="#cb39-39"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb39-40"><a href="#cb39-40"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb39-41"><a href="#cb39-41"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb39-42"><a href="#cb39-42"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>the result shows that the power curve crosses the horizontal line corresponding to <span class="math inline">\(\alpha=0.1\)</span> at both endpoints, <span class="math inline">\(\epsilon=0\)</span> and <span class="math inline">\(\epsilon=1\)</span> where the alternative is normally distributed. For <span class="math inline">\(0 &lt; \epsilon &lt; 1\)</span> the empirical power of the test is greater than 0.10 and highest when <span class="math inline">\(\epsilon\)</span> is about 0.15.</p>
</div>
<div id="a-21016-2021-10-28" class="section level2">
<h2>A-21016-2021-10-28</h2>
</div>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.7, 7.8, 7.9, and 7.B (pages 213, Statistical Computating with R).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>7.7</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb40-3"><a href="#cb40-3"></a>data=scor</span>
<span id="cb40-4"><a href="#cb40-4"></a>B=<span class="dv">2000</span></span>
<span id="cb40-5"><a href="#cb40-5"></a>n=<span class="kw">nrow</span>(data)</span>
<span id="cb40-6"><a href="#cb40-6"></a>covhat=<span class="kw">cov</span>(data)</span>
<span id="cb40-7"><a href="#cb40-7"></a>eigenhat=<span class="kw">eigen</span>(covhat)</span>
<span id="cb40-8"><a href="#cb40-8"></a>thetahat=eigenhat<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eigenhat<span class="op">$</span>values)</span>
<span id="cb40-9"><a href="#cb40-9"></a>thetastar=<span class="kw">numeric</span>(B)</span>
<span id="cb40-10"><a href="#cb40-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B)</span>
<span id="cb40-11"><a href="#cb40-11"></a>{</span>
<span id="cb40-12"><a href="#cb40-12"></a>  index=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n),n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb40-13"><a href="#cb40-13"></a>  xstar=data[index,]</span>
<span id="cb40-14"><a href="#cb40-14"></a>  cov=<span class="kw">cov</span>(xstar)</span>
<span id="cb40-15"><a href="#cb40-15"></a>  eigen=<span class="kw">eigen</span>(cov)</span>
<span id="cb40-16"><a href="#cb40-16"></a>  thetastar[i]=eigen<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eigen<span class="op">$</span>values)</span>
<span id="cb40-17"><a href="#cb40-17"></a>}</span>
<span id="cb40-18"><a href="#cb40-18"></a>bias=<span class="kw">mean</span>(thetastar)<span class="op">-</span>thetahat</span>
<span id="cb40-19"><a href="#cb40-19"></a>sd=<span class="kw">sd</span>(thetastar)</span>
<span id="cb40-20"><a href="#cb40-20"></a><span class="kw">c</span>(<span class="dt">bias.boot=</span>bias,<span class="dt">sd.boot=</span>sd)</span></code></pre></div>
<pre><code>##   bias.boot     sd.boot 
## 0.001492416 0.047993067</code></pre>
<p>7.8</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb42-2"><a href="#cb42-2"></a>stat&lt;-<span class="cf">function</span>(x,i){</span>
<span id="cb42-3"><a href="#cb42-3"></a>  cov=<span class="kw">cov</span>(x[i,])</span>
<span id="cb42-4"><a href="#cb42-4"></a>  eigen=<span class="kw">eigen</span>(cov)</span>
<span id="cb42-5"><a href="#cb42-5"></a>  theta=eigen<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eigen<span class="op">$</span>values)</span>
<span id="cb42-6"><a href="#cb42-6"></a>  <span class="kw">return</span>(theta)</span>
<span id="cb42-7"><a href="#cb42-7"></a>}</span>
<span id="cb42-8"><a href="#cb42-8"></a></span>
<span id="cb42-9"><a href="#cb42-9"></a>data=scor</span>
<span id="cb42-10"><a href="#cb42-10"></a>n=<span class="kw">nrow</span>(data)</span>
<span id="cb42-11"><a href="#cb42-11"></a>thetahat=<span class="kw">stat</span>(data,(<span class="dv">1</span><span class="op">:</span>n))</span>
<span id="cb42-12"><a href="#cb42-12"></a></span>
<span id="cb42-13"><a href="#cb42-13"></a>theta.jack=<span class="kw">numeric</span>(n)</span>
<span id="cb42-14"><a href="#cb42-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb42-15"><a href="#cb42-15"></a>  theta.jack[i]=<span class="kw">stat</span>(data,(<span class="dv">1</span><span class="op">:</span>n)[<span class="op">-</span>i])</span>
<span id="cb42-16"><a href="#cb42-16"></a>}</span>
<span id="cb42-17"><a href="#cb42-17"></a>bias.jack &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.jack)<span class="op">-</span>thetahat)</span>
<span id="cb42-18"><a href="#cb42-18"></a>se.jack &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.jack<span class="op">-</span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb42-19"><a href="#cb42-19"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">thetahat=</span>thetahat,<span class="dt">bias.jack=</span>bias.jack,</span>
<span id="cb42-20"><a href="#cb42-20"></a><span class="dt">se.jack=</span>se.jack),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##  thetahat bias.jack   se.jack 
##    0.6191    0.0011    0.0496</code></pre>
<p>7.9</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb44-3"><a href="#cb44-3"></a>stat&lt;-<span class="cf">function</span>(x,i){</span>
<span id="cb44-4"><a href="#cb44-4"></a>  cov=<span class="kw">cov</span>(x[i,])</span>
<span id="cb44-5"><a href="#cb44-5"></a>  eigen=<span class="kw">eigen</span>(cov)</span>
<span id="cb44-6"><a href="#cb44-6"></a>  theta=eigen<span class="op">$</span>values[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(eigen<span class="op">$</span>values)</span>
<span id="cb44-7"><a href="#cb44-7"></a>  <span class="kw">return</span>(theta)</span>
<span id="cb44-8"><a href="#cb44-8"></a>}</span>
<span id="cb44-9"><a href="#cb44-9"></a>data=scor</span>
<span id="cb44-10"><a href="#cb44-10"></a>obj=<span class="kw">boot</span>(data,stat,<span class="dt">R=</span><span class="dv">2000</span>)</span>
<span id="cb44-11"><a href="#cb44-11"></a>ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb44-12"><a href="#cb44-12"></a>ci.perc&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb44-13"><a href="#cb44-13"></a>ci.bca&lt;-ci<span class="op">$</span>bca[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="kw">c</span>(<span class="dt">ci.perc=</span>ci.perc,<span class="dt">ci.bca=</span>ci.bca)</span></code></pre></div>
<pre><code>##  ci.perc1  ci.perc2   ci.bca1   ci.bca2 
## 0.5221113 0.7088348 0.5220812 0.7086439</code></pre>
<p>7.B</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb46-2"><a href="#cb46-2"></a>stat&lt;-<span class="cf">function</span>(x,i){</span>
<span id="cb46-3"><a href="#cb46-3"></a>  xbar=<span class="kw">mean</span>(x[i])</span>
<span id="cb46-4"><a href="#cb46-4"></a>  m2=<span class="kw">mean</span>((x[i]<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb46-5"><a href="#cb46-5"></a>  m3=<span class="kw">mean</span>((x[i]<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb46-6"><a href="#cb46-6"></a>  <span class="kw">return</span>(m2<span class="op">/</span>m3<span class="op">^</span><span class="fl">1.5</span>)</span>
<span id="cb46-7"><a href="#cb46-7"></a>}</span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="co">#normal populations (skewness 0)</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>m=<span class="fl">1e3</span></span>
<span id="cb46-10"><a href="#cb46-10"></a>n=<span class="dv">20</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>u=<span class="dv">1</span>;sd=<span class="dv">1</span></span>
<span id="cb46-12"><a href="#cb46-12"></a>ci.basic&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb46-13"><a href="#cb46-13"></a>ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb46-14"><a href="#cb46-14"></a>ci.norm&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb46-15"><a href="#cb46-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb46-16"><a href="#cb46-16"></a>data=<span class="kw">rnorm</span>(n,u,sd)</span>
<span id="cb46-17"><a href="#cb46-17"></a>obj=<span class="kw">boot</span>(data,stat,<span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb46-18"><a href="#cb46-18"></a>ci=<span class="kw">boot.ci</span>(obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb46-19"><a href="#cb46-19"></a>ci.norm[i,]=ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb46-20"><a href="#cb46-20"></a>ci.basic[i,]=ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb46-21"><a href="#cb46-21"></a>ci.perc[i,]=ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb46-22"><a href="#cb46-22"></a>}</span>
<span id="cb46-23"><a href="#cb46-23"></a><span class="co">#正态分布N(1,1)的norm,basic,percent置信区间覆盖率</span></span>
<span id="cb46-24"><a href="#cb46-24"></a><span class="kw">cat</span>(<span class="st">&#39;normalnorm =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb46-25"><a href="#cb46-25"></a>    <span class="st">&#39;normalbasic =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb46-26"><a href="#cb46-26"></a><span class="st">&#39;normalperc =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## normalnorm = 0.882 normalbasic = 0.882 normalperc = 0.97</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co">#正态分布N(1,1)的norm,basic,percent置信区间左侧和右侧覆盖率</span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="kw">cat</span>(<span class="st">&#39;normalnormleft =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span>),</span>
<span id="cb48-3"><a href="#cb48-3"></a>    <span class="st">&#39;normalnormright =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb48-4"><a href="#cb48-4"></a>    <span class="st">&#39;normalbasicleft =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>),</span>
<span id="cb48-5"><a href="#cb48-5"></a>    <span class="st">&#39;normalbasicright =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>),</span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="st">&#39;normalpercleft =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="dv">0</span>),</span>
<span id="cb48-7"><a href="#cb48-7"></a><span class="st">&#39;normalpercright =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span><span class="dv">0</span>))</span></code></pre></div>
<pre><code>## normalnormleft = 0.94 normalnormright = 0.942 normalbasicleft = 0.943 normalbasicright = 0.939 normalpercleft = 0.987 normalpercright = 0.983</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="co">#χ2(5) distributions </span></span>
<span id="cb50-2"><a href="#cb50-2"></a>df=<span class="dv">5</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>skewness=<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span>df)</span>
<span id="cb50-4"><a href="#cb50-4"></a>ci.basic&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb50-5"><a href="#cb50-5"></a>ci.perc&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb50-6"><a href="#cb50-6"></a>ci.norm&lt;-<span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb50-7"><a href="#cb50-7"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb50-8"><a href="#cb50-8"></a>data=<span class="kw">rchisq</span>(n,df)</span>
<span id="cb50-9"><a href="#cb50-9"></a>obj=<span class="kw">boot</span>(data,stat,<span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb50-10"><a href="#cb50-10"></a>ci=<span class="kw">boot.ci</span>(obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb50-11"><a href="#cb50-11"></a>ci.norm[i,]=ci<span class="op">$</span>norm[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]</span>
<span id="cb50-12"><a href="#cb50-12"></a>ci.basic[i,]=ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb50-13"><a href="#cb50-13"></a>ci.perc[i,]=ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb50-14"><a href="#cb50-14"></a>}</span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="co">#卡方分布norm,basic,percent置信区间覆盖率</span></span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="kw">cat</span>(<span class="st">&#39;chisqnorm =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>skewness <span class="op">&amp;</span><span class="st"> </span>ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>skewness),</span>
<span id="cb50-17"><a href="#cb50-17"></a>    <span class="st">&#39;chisqbasic =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>skewness <span class="op">&amp;</span><span class="st"> </span>ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>skewness),</span>
<span id="cb50-18"><a href="#cb50-18"></a><span class="st">&#39;chisqperc =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>skewness <span class="op">&amp;</span><span class="st"> </span>ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>skewness))</span></code></pre></div>
<pre><code>## chisqnorm = 0.746 chisqbasic = 0.719 chisqperc = 0.729</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="co">#卡方分布norm,basic,percent置信区间的左侧和右侧的覆盖率</span></span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="kw">cat</span>(<span class="st">&#39;chisqnormleft =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>skewness),</span>
<span id="cb52-3"><a href="#cb52-3"></a>    <span class="st">&#39;chisqnormright =&#39;</span>,<span class="kw">mean</span>(ci.norm[,<span class="dv">2</span>]<span class="op">&gt;=</span>skewness),</span>
<span id="cb52-4"><a href="#cb52-4"></a>    <span class="st">&#39;chisqbasicleft =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">1</span>]<span class="op">&lt;=</span><span class="st"> </span>skewness),</span>
<span id="cb52-5"><a href="#cb52-5"></a>    <span class="st">&#39;chisqbasicright =&#39;</span>,<span class="kw">mean</span>(ci.basic[,<span class="dv">2</span>]<span class="op">&gt;=</span>skewness),</span>
<span id="cb52-6"><a href="#cb52-6"></a><span class="st">&#39;chisqpercleft =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">1</span>]<span class="op">&lt;=</span>skewness),</span>
<span id="cb52-7"><a href="#cb52-7"></a><span class="st">&#39;chisqpercright =&#39;</span>,<span class="kw">mean</span>(ci.perc[,<span class="dv">2</span>]<span class="op">&gt;=</span>skewness))</span></code></pre></div>
<pre><code>## chisqnormleft = 0.979 chisqnormright = 0.767 chisqbasicleft = 0.961 chisqbasicright = 0.758 chisqpercleft = 1 chisqpercright = 0.729</code></pre>
</div>
<div id="a-21016-2021-11-04" class="section level2">
<h2>A-21016-2021-11-04</h2>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>1.Exercise 8.2 (page 242, Statistical Computating with R).<br />
2.Design experiments for evaluating the performance of the NN,energy, and ball methods in various situations.<br />
Unequal variances and equal expectations<br />
Unequal variances and unequal expectations<br />
Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)<br />
Unbalanced samples (say, 1 case versus 10 controls)<br />
Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<p>8.2<br />
Use the samples from normal distribution, <span class="math inline">\(x \sim N(0,1)\)</span> and <span class="math inline">\(y \sim N(100,1)\)</span>, n=30.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb54-2"><a href="#cb54-2"></a>R=<span class="dv">999</span></span>
<span id="cb54-3"><a href="#cb54-3"></a>K=<span class="dv">1</span><span class="op">:</span><span class="dv">60</span></span>
<span id="cb54-4"><a href="#cb54-4"></a>n&lt;-<span class="dv">30</span></span>
<span id="cb54-5"><a href="#cb54-5"></a>x&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb54-6"><a href="#cb54-6"></a>y&lt;-<span class="kw">rnorm</span>(n,<span class="dv">100</span>,<span class="dv">1</span>)</span>
<span id="cb54-7"><a href="#cb54-7"></a>z&lt;-<span class="kw">c</span>(x,y)</span>
<span id="cb54-8"><a href="#cb54-8"></a>t0_cortest&lt;-<span class="kw">cor.test</span>(x,y)<span class="op">$</span>statistic</span>
<span id="cb54-9"><a href="#cb54-9"></a>p0_cortest&lt;-<span class="kw">cor.test</span>(x,y)<span class="op">$</span>p.value</span>
<span id="cb54-10"><a href="#cb54-10"></a>t0_spearman&lt;-<span class="kw">cor</span>(x,y,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb54-11"><a href="#cb54-11"></a>rep1=<span class="kw">numeric</span>(R)</span>
<span id="cb54-12"><a href="#cb54-12"></a>rep2=<span class="kw">numeric</span>(R)</span>
<span id="cb54-13"><a href="#cb54-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R){</span>
<span id="cb54-14"><a href="#cb54-14"></a>  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb54-15"><a href="#cb54-15"></a>  x1 &lt;-<span class="st"> </span>z[k]; y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k] </span>
<span id="cb54-16"><a href="#cb54-16"></a>  rep1[i] &lt;-<span class="st"> </span><span class="kw">cor.test</span>(x1, y1)<span class="op">$</span>statistic</span>
<span id="cb54-17"><a href="#cb54-17"></a>  rep2[i]&lt;-<span class="kw">cor</span>(x1,y1,<span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb54-18"><a href="#cb54-18"></a>}</span>
<span id="cb54-19"><a href="#cb54-19"></a>p_cortest &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0_cortest, rep1)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0_cortest))</span>
<span id="cb54-20"><a href="#cb54-20"></a>p_spearman &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">abs</span>(<span class="kw">c</span>(t0_spearman, rep2)) <span class="op">&gt;=</span><span class="st"> </span><span class="kw">abs</span>(t0_spearman))</span>
<span id="cb54-21"><a href="#cb54-21"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">p0_cortest=</span>p0_cortest,<span class="dt">p_cortest=</span>p_cortest,<span class="dt">p_spearman=</span>p_spearman),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## p0_cortest  p_cortest p_spearman 
##      0.002      0.006      0.002</code></pre>
<p>we set <span class="math inline">\(\alpha=0.05\)</span> and both the bivariate Spearman rank correlation test and cor test can reject the null hypothesis. From the result the pvalue of spearman is smaller than pvalue of cortest.</p>
<p>2</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">library</span>(RANN) </span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="kw">library</span>(boot)</span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="kw">library</span>(energy)</span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="kw">library</span>(Ball)</span>
<span id="cb56-5"><a href="#cb56-5"></a></span>
<span id="cb56-6"><a href="#cb56-6"></a><span class="co">#NN</span></span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb56-8"><a href="#cb56-8"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb56-9"><a href="#cb56-9"></a>n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]; n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb56-10"><a href="#cb56-10"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z);</span>
<span id="cb56-11"><a href="#cb56-11"></a>z &lt;-<span class="st"> </span>z[ix, ];</span>
<span id="cb56-12"><a href="#cb56-12"></a>NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># What is the first column?</span></span>
<span id="cb56-13"><a href="#cb56-13"></a>block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb56-14"><a href="#cb56-14"></a>block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb56-15"><a href="#cb56-15"></a>i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;=</span><span class="st"> </span>n1); i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1)</span>
<span id="cb56-16"><a href="#cb56-16"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb56-17"><a href="#cb56-17"></a>}</span>
<span id="cb56-18"><a href="#cb56-18"></a><span class="co">#Unequal variances and equal expectations  </span></span>
<span id="cb56-19"><a href="#cb56-19"></a>n=<span class="dv">30</span></span>
<span id="cb56-20"><a href="#cb56-20"></a>x&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb56-21"><a href="#cb56-21"></a>y&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb56-22"><a href="#cb56-22"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb56-23"><a href="#cb56-23"></a>N=<span class="kw">c</span>(<span class="kw">length</span>(x),<span class="kw">length</span>(y))</span>
<span id="cb56-24"><a href="#cb56-24"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb56-25"><a href="#cb56-25"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N, <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb56-26"><a href="#cb56-26"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb56-27"><a href="#cb56-27"></a>NN_p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb56-28"><a href="#cb56-28"></a></span>
<span id="cb56-29"><a href="#cb56-29"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb56-30"><a href="#cb56-30"></a>energy_p.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb56-31"><a href="#cb56-31"></a>ball_p.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">num.permutations=</span><span class="dv">9999</span>)<span class="op">$</span>p.value</span>
<span id="cb56-32"><a href="#cb56-32"></a></span>
<span id="cb56-33"><a href="#cb56-33"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">NN_p.value=</span>NN_p.value,<span class="dt">energy_p.value=</span>energy_p.value,ball_p.value),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##         NN_p.value     energy_p.value bd.constant.pvalue 
##              1e-03              1e-03              1e-04</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co">#Unequal variances and unequal expectations </span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb58-3"><a href="#cb58-3"></a>n=<span class="dv">30</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>x&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb58-5"><a href="#cb58-5"></a>y&lt;-<span class="kw">rnorm</span>(n,<span class="dv">2</span>,<span class="dv">5</span>)</span>
<span id="cb58-6"><a href="#cb58-6"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb58-7"><a href="#cb58-7"></a>N=<span class="kw">c</span>(<span class="kw">length</span>(x),<span class="kw">length</span>(y))</span>
<span id="cb58-8"><a href="#cb58-8"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb58-9"><a href="#cb58-9"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N, <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb58-10"><a href="#cb58-10"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb58-11"><a href="#cb58-11"></a>NN_p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb58-12"><a href="#cb58-12"></a></span>
<span id="cb58-13"><a href="#cb58-13"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb58-14"><a href="#cb58-14"></a>energy_p.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb58-15"><a href="#cb58-15"></a>ball_p.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">num.permutations=</span><span class="dv">9999</span>)<span class="op">$</span>p.value</span>
<span id="cb58-16"><a href="#cb58-16"></a></span>
<span id="cb58-17"><a href="#cb58-17"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">NN_p.value=</span>NN_p.value,<span class="dt">energy_p.value=</span>energy_p.value,ball_p.value),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##         NN_p.value     energy_p.value bd.constant.pvalue 
##              1e-03              1e-03              1e-04</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co">#t distribution with 1 df (heavy-tailed</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="co">#distribution), bimodel distribution (mixture of two normal</span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="co">#distributions)</span></span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="kw">set.seed</span>(<span class="dv">345</span>)</span>
<span id="cb60-5"><a href="#cb60-5"></a>n=<span class="dv">30</span></span>
<span id="cb60-6"><a href="#cb60-6"></a>x&lt;-<span class="kw">rt</span>(n,<span class="dv">1</span>)</span>
<span id="cb60-7"><a href="#cb60-7"></a>y1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb60-8"><a href="#cb60-8"></a>y2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb60-9"><a href="#cb60-9"></a>k&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb60-10"><a href="#cb60-10"></a>y&lt;-k<span class="op">*</span>y1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>k)<span class="op">*</span>y2</span>
<span id="cb60-11"><a href="#cb60-11"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb60-12"><a href="#cb60-12"></a>N=<span class="kw">c</span>(<span class="kw">length</span>(x),<span class="kw">length</span>(y))</span>
<span id="cb60-13"><a href="#cb60-13"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb60-14"><a href="#cb60-14"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N, <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb60-15"><a href="#cb60-15"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb60-16"><a href="#cb60-16"></a>NN_p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb60-17"><a href="#cb60-17"></a></span>
<span id="cb60-18"><a href="#cb60-18"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb60-19"><a href="#cb60-19"></a>energy_p.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb60-20"><a href="#cb60-20"></a>ball_p.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">num.permutations=</span><span class="dv">9999</span>)<span class="op">$</span>p.value</span>
<span id="cb60-21"><a href="#cb60-21"></a></span>
<span id="cb60-22"><a href="#cb60-22"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">NN_p.value=</span>NN_p.value,<span class="dt">energy_p.value=</span>energy_p.value,ball_p.value),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##         NN_p.value     energy_p.value bd.constant.pvalue 
##             0.0800             0.0070             0.0029</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="co">#Unbalanced samples (say, 1 case versus 10 controls)</span></span>
<span id="cb62-2"><a href="#cb62-2"></a><span class="kw">set.seed</span>(<span class="dv">234</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>n1=<span class="dv">10</span>;n2=<span class="dv">100</span></span>
<span id="cb62-4"><a href="#cb62-4"></a>x&lt;-<span class="kw">rnorm</span>(n1,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb62-5"><a href="#cb62-5"></a>y&lt;-<span class="kw">rnorm</span>(n2,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb62-6"><a href="#cb62-6"></a></span>
<span id="cb62-7"><a href="#cb62-7"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb62-8"><a href="#cb62-8"></a>N=<span class="kw">c</span>(<span class="kw">length</span>(x),<span class="kw">length</span>(y))</span>
<span id="cb62-9"><a href="#cb62-9"></a>boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> z, <span class="dt">statistic =</span> Tn, <span class="dt">R =</span> <span class="dv">999</span>,</span>
<span id="cb62-10"><a href="#cb62-10"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> N, <span class="dt">k=</span><span class="dv">3</span>)</span>
<span id="cb62-11"><a href="#cb62-11"></a>ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb62-12"><a href="#cb62-12"></a>NN_p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb62-13"><a href="#cb62-13"></a></span>
<span id="cb62-14"><a href="#cb62-14"></a>boot.obs &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z, <span class="dt">sizes=</span>N, <span class="dt">R=</span><span class="dv">999</span>)</span>
<span id="cb62-15"><a href="#cb62-15"></a>energy_p.value &lt;-<span class="st"> </span>boot.obs<span class="op">$</span>p.value</span>
<span id="cb62-16"><a href="#cb62-16"></a>ball_p.value =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">num.permutations=</span><span class="dv">9999</span>)<span class="op">$</span>p.value</span>
<span id="cb62-17"><a href="#cb62-17"></a></span>
<span id="cb62-18"><a href="#cb62-18"></a><span class="kw">round</span>(<span class="kw">c</span>(<span class="dt">NN_p.value=</span>NN_p.value,<span class="dt">energy_p.value=</span>energy_p.value,ball_p.value),<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##         NN_p.value     energy_p.value bd.constant.pvalue 
##              1e-03              1e-03              1e-04</code></pre>
<p>From the result, we can conclude that the Pvalue of NN method is the largest in various situations, and the Pvalue of ball method is the smallest.<br />
In various situations, the energy and ball method can distinguish the sample well(<span class="math inline">\(\alpha=0.05\)</span> and <span class="math inline">\(p&lt;\alpha\)</span>). However, in the Non-normal distributions samples, the NN method cannot reject the null hypothesis when <span class="math inline">\(\alpha=0.05\)</span>, it seem that the energy and ball method is better than NN when the sample from Non-normal distributions.</p>
</div>
<div id="a-21016-2021-11-11" class="section level2">
<h2>A-21016-2021-11-11</h2>
</div>
<div id="qusetion" class="section level2">
<h2>Qusetion</h2>
<p>Exercies 9.3 and 9.8 (pages 277-278, Statistical Computating with R). For each of the above exercise, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to R &lt; 1.2.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
</div>
<div id="section-6" class="section level2">
<h2>9.3</h2>
<p>For the standard Cauchy distribution, choose normal distribution <span class="math inline">\(Y|X_t \sim N(X_t,\sigma^2)\)</span>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb64-2"><a href="#cb64-2"></a>m&lt;-<span class="dv">5000</span></span>
<span id="cb64-3"><a href="#cb64-3"></a>sigma=<span class="fl">0.5</span></span>
<span id="cb64-4"><a href="#cb64-4"></a>x&lt;-<span class="kw">numeric</span>(m)</span>
<span id="cb64-5"><a href="#cb64-5"></a>x[<span class="dv">1</span>]&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,sigma)</span>
<span id="cb64-6"><a href="#cb64-6"></a>k=<span class="dv">0</span></span>
<span id="cb64-7"><a href="#cb64-7"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</span>
<span id="cb64-8"><a href="#cb64-8"></a></span>
<span id="cb64-9"><a href="#cb64-9"></a>  </span>
<span id="cb64-10"><a href="#cb64-10"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m){</span>
<span id="cb64-11"><a href="#cb64-11"></a>  y&lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb64-12"><a href="#cb64-12"></a>  <span class="cf">if</span>(u[i]<span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dt</span>(y, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">dt</span>(x[i<span class="dv">-1</span>], <span class="dv">1</span>)) ) x[i]=y</span>
<span id="cb64-13"><a href="#cb64-13"></a>  <span class="cf">else</span> {x[i]=x[i<span class="dv">-1</span>]</span>
<span id="cb64-14"><a href="#cb64-14"></a>  k=k<span class="op">+</span><span class="dv">1</span>}</span>
<span id="cb64-15"><a href="#cb64-15"></a>}</span>
<span id="cb64-16"><a href="#cb64-16"></a></span>
<span id="cb64-17"><a href="#cb64-17"></a>b&lt;-<span class="dv">1001</span></span>
<span id="cb64-18"><a href="#cb64-18"></a>y1&lt;-x[b<span class="op">:</span>m]</span>
<span id="cb64-19"><a href="#cb64-19"></a>a&lt;-<span class="kw">ppoints</span>(<span class="dv">10</span>)</span>
<span id="cb64-20"><a href="#cb64-20"></a>Qsample &lt;-<span class="st"> </span><span class="kw">quantile</span>(y1, a)</span>
<span id="cb64-21"><a href="#cb64-21"></a>QR&lt;-<span class="kw">qt</span>(a,<span class="dv">1</span>)</span>
<span id="cb64-22"><a href="#cb64-22"></a><span class="kw">qqplot</span>(QR, Qsample, <span class="dt">main=</span><span class="st">&quot;&quot;</span>,</span>
<span id="cb64-23"><a href="#cb64-23"></a><span class="dt">xlab=</span><span class="st">&quot;Standard Cauchy Quantiles&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Sample Quantiles&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a>res&lt;-<span class="kw">data.frame</span>(QR,Qsample)</span>
<span id="cb65-2"><a href="#cb65-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>(res)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">QR</th>
<th align="right">Qsample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">6.097561%</td>
<td align="right">-5.1562719</td>
<td align="right">-5.0727732</td>
</tr>
<tr class="even">
<td align="left">15.85366%</td>
<td align="right">-1.8389697</td>
<td align="right">-2.2942948</td>
</tr>
<tr class="odd">
<td align="left">25.60976%</td>
<td align="right">-0.9624035</td>
<td align="right">-1.3283044</td>
</tr>
<tr class="even">
<td align="left">35.36585%</td>
<td align="right">-0.4951315</td>
<td align="right">-0.7415115</td>
</tr>
<tr class="odd">
<td align="left">45.12195%</td>
<td align="right">-0.1544595</td>
<td align="right">-0.3264677</td>
</tr>
<tr class="even">
<td align="left">54.87805%</td>
<td align="right">0.1544595</td>
<td align="right">0.0488675</td>
</tr>
<tr class="odd">
<td align="left">64.63415%</td>
<td align="right">0.4951315</td>
<td align="right">0.4040446</td>
</tr>
<tr class="even">
<td align="left">74.39024%</td>
<td align="right">0.9624035</td>
<td align="right">0.7845436</td>
</tr>
<tr class="odd">
<td align="left">84.14634%</td>
<td align="right">1.8389697</td>
<td align="right">1.4893191</td>
</tr>
<tr class="even">
<td align="left">93.90244%</td>
<td align="right">5.1562719</td>
<td align="right">3.2214994</td>
</tr>
</tbody>
</table>
</div>
<div id="section-7" class="section level2">
<h2>9.8</h2>
<p>set a=2,b=1,n=10</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>N=<span class="dv">5000</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>burn=<span class="dv">1000</span></span>
<span id="cb66-3"><a href="#cb66-3"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb66-4"><a href="#cb66-4"></a>a=<span class="dv">2</span></span>
<span id="cb66-5"><a href="#cb66-5"></a>b=<span class="dv">1</span></span>
<span id="cb66-6"><a href="#cb66-6"></a>n=<span class="dv">10</span></span>
<span id="cb66-7"><a href="#cb66-7"></a>X[<span class="dv">1</span>,]=<span class="kw">c</span>(<span class="dv">5</span>,<span class="fl">0.5</span>)</span>
<span id="cb66-8"><a href="#cb66-8"></a></span>
<span id="cb66-9"><a href="#cb66-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb66-10"><a href="#cb66-10"></a>x2 &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb66-11"><a href="#cb66-11"></a>X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb66-12"><a href="#cb66-12"></a>x1 &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb66-13"><a href="#cb66-13"></a>X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,x1<span class="op">+</span>a,n<span class="op">-</span>x1<span class="op">+</span>b)</span>
<span id="cb66-14"><a href="#cb66-14"></a>}</span>
<span id="cb66-15"><a href="#cb66-15"></a>b &lt;-<span class="st"> </span>burn <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb66-16"><a href="#cb66-16"></a>x &lt;-<span class="st"> </span>X[b<span class="op">:</span>N, ]</span>
<span id="cb66-17"><a href="#cb66-17"></a><span class="kw">plot</span>(x, <span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">cex=</span>.<span class="dv">5</span>, <span class="dt">xlab=</span><span class="kw">bquote</span>(X[<span class="dv">1</span>]),</span>
<span id="cb66-18"><a href="#cb66-18"></a>     <span class="dt">ylab=</span><span class="kw">bquote</span>(X[<span class="dv">2</span>]), <span class="dt">ylim=</span><span class="kw">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="convergence-of-the-chain" class="section level2">
<h2>convergence of the chain</h2>
<p>9.3</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co">#monitor convergence of the chain</span></span>
<span id="cb67-2"><a href="#cb67-2"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb67-3"><a href="#cb67-3"></a>  psi&lt;-<span class="kw">as.matrix</span>(psi)</span>
<span id="cb67-4"><a href="#cb67-4"></a>  m&lt;-<span class="kw">ncol</span>(psi)</span>
<span id="cb67-5"><a href="#cb67-5"></a>  n&lt;-<span class="kw">nrow</span>(psi)</span>
<span id="cb67-6"><a href="#cb67-6"></a>  psi.means&lt;-<span class="kw">rowMeans</span>(psi)</span>
<span id="cb67-7"><a href="#cb67-7"></a>  B&lt;-n<span class="op">*</span><span class="kw">var</span>(psi.means)</span>
<span id="cb67-8"><a href="#cb67-8"></a>  psi.w&lt;-<span class="kw">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb67-9"><a href="#cb67-9"></a>  W&lt;-<span class="kw">mean</span>(psi.w)</span>
<span id="cb67-10"><a href="#cb67-10"></a>  v.hat&lt;-W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">+</span>B<span class="op">/</span>n</span>
<span id="cb67-11"><a href="#cb67-11"></a>  r.hat&lt;-v.hat<span class="op">/</span>W</span>
<span id="cb67-12"><a href="#cb67-12"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb67-13"><a href="#cb67-13"></a>}</span>
<span id="cb67-14"><a href="#cb67-14"></a></span>
<span id="cb67-15"><a href="#cb67-15"></a>cauchy.chain&lt;-<span class="cf">function</span>(sigma,N,X1){</span>
<span id="cb67-16"><a href="#cb67-16"></a>  x&lt;-<span class="kw">rep</span>(<span class="dv">0</span>,N)</span>
<span id="cb67-17"><a href="#cb67-17"></a>  x[<span class="dv">1</span>]&lt;-X1</span>
<span id="cb67-18"><a href="#cb67-18"></a>  u&lt;-<span class="kw">runif</span>(N)</span>
<span id="cb67-19"><a href="#cb67-19"></a>  </span>
<span id="cb67-20"><a href="#cb67-20"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N){</span>
<span id="cb67-21"><a href="#cb67-21"></a>    y&lt;-<span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma)</span>
<span id="cb67-22"><a href="#cb67-22"></a>    r=<span class="kw">dt</span>(y,<span class="dv">1</span>)<span class="op">/</span><span class="kw">dt</span>(x[i<span class="dv">-1</span>],<span class="dv">1</span>)</span>
<span id="cb67-23"><a href="#cb67-23"></a>    <span class="cf">if</span>(u[i]<span class="op">&lt;=</span>r) x[i]=y</span>
<span id="cb67-24"><a href="#cb67-24"></a>    <span class="cf">else</span> x[i]=x[i<span class="dv">-1</span>]</span>
<span id="cb67-25"><a href="#cb67-25"></a>  }</span>
<span id="cb67-26"><a href="#cb67-26"></a>  <span class="kw">return</span>(x)</span>
<span id="cb67-27"><a href="#cb67-27"></a>}</span>
<span id="cb67-28"><a href="#cb67-28"></a></span>
<span id="cb67-29"><a href="#cb67-29"></a><span class="kw">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb67-30"><a href="#cb67-30"></a>sigma=<span class="fl">0.5</span></span>
<span id="cb67-31"><a href="#cb67-31"></a>n&lt;-<span class="dv">20000</span></span>
<span id="cb67-32"><a href="#cb67-32"></a>b&lt;-<span class="dv">1000</span></span>
<span id="cb67-33"><a href="#cb67-33"></a>x0&lt;-<span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb67-34"><a href="#cb67-34"></a>X&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,n)</span>
<span id="cb67-35"><a href="#cb67-35"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb67-36"><a href="#cb67-36"></a>  X[i,]=<span class="kw">cauchy.chain</span>(sigma,n,x0[i])</span>
<span id="cb67-37"><a href="#cb67-37"></a></span>
<span id="cb67-38"><a href="#cb67-38"></a>psi&lt;-<span class="kw">t</span>(<span class="kw">apply</span>(X,<span class="dv">1</span>,cumsum))</span>
<span id="cb67-39"><a href="#cb67-39"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb67-40"><a href="#cb67-40"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb67-41"><a href="#cb67-41"></a></span>
<span id="cb67-42"><a href="#cb67-42"></a></span>
<span id="cb67-43"><a href="#cb67-43"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb67-44"><a href="#cb67-44"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb67-45"><a href="#cb67-45"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)</span>
<span id="cb67-46"><a href="#cb67-46"></a><span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb67-47"><a href="#cb67-47"></a><span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb68-2"><a href="#cb68-2"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">5.1</span>,<span class="fl">4.1</span>,<span class="fl">4.1</span>,<span class="fl">2.1</span>))</span>
<span id="cb68-3"><a href="#cb68-3"></a></span>
<span id="cb68-4"><a href="#cb68-4"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb68-5"><a href="#cb68-5"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n)</span>
<span id="cb68-6"><a href="#cb68-6"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb68-7"><a href="#cb68-7"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb68-8"><a href="#cb68-8"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>9.8</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb69-2"><a href="#cb69-2"></a>  psi&lt;-<span class="kw">as.matrix</span>(psi)</span>
<span id="cb69-3"><a href="#cb69-3"></a>  m&lt;-<span class="kw">ncol</span>(psi)</span>
<span id="cb69-4"><a href="#cb69-4"></a>  n&lt;-<span class="kw">nrow</span>(psi)</span>
<span id="cb69-5"><a href="#cb69-5"></a>  psi.means&lt;-<span class="kw">rowMeans</span>(psi)</span>
<span id="cb69-6"><a href="#cb69-6"></a>  B&lt;-n<span class="op">*</span><span class="kw">var</span>(psi.means)</span>
<span id="cb69-7"><a href="#cb69-7"></a>  psi.w&lt;-<span class="kw">apply</span>(psi,<span class="dv">1</span>,<span class="st">&quot;var&quot;</span>)</span>
<span id="cb69-8"><a href="#cb69-8"></a>  W&lt;-<span class="kw">mean</span>(psi.w)</span>
<span id="cb69-9"><a href="#cb69-9"></a>  v.hat&lt;-W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n<span class="op">+</span>B<span class="op">/</span>n</span>
<span id="cb69-10"><a href="#cb69-10"></a>  r.hat&lt;-v.hat<span class="op">/</span>W</span>
<span id="cb69-11"><a href="#cb69-11"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb69-12"><a href="#cb69-12"></a>}</span>
<span id="cb69-13"><a href="#cb69-13"></a></span>
<span id="cb69-14"><a href="#cb69-14"></a>gibbs.chain&lt;-<span class="cf">function</span>(N,x0){</span>
<span id="cb69-15"><a href="#cb69-15"></a>  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</span>
<span id="cb69-16"><a href="#cb69-16"></a>  a=<span class="dv">2</span></span>
<span id="cb69-17"><a href="#cb69-17"></a>  b=<span class="dv">1</span></span>
<span id="cb69-18"><a href="#cb69-18"></a>  n=<span class="dv">10</span></span>
<span id="cb69-19"><a href="#cb69-19"></a>  X[<span class="dv">1</span>,]=x0</span>
<span id="cb69-20"><a href="#cb69-20"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb69-21"><a href="#cb69-21"></a>x2 &lt;-<span class="st"> </span>X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb69-22"><a href="#cb69-22"></a>X[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">1</span>, n, x2)</span>
<span id="cb69-23"><a href="#cb69-23"></a>x1 &lt;-<span class="st"> </span>X[i, <span class="dv">1</span>]</span>
<span id="cb69-24"><a href="#cb69-24"></a>X[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,x1<span class="op">+</span>a,n<span class="op">-</span>x1<span class="op">+</span>b)</span>
<span id="cb69-25"><a href="#cb69-25"></a>}</span>
<span id="cb69-26"><a href="#cb69-26"></a>  <span class="kw">return</span>(X)</span>
<span id="cb69-27"><a href="#cb69-27"></a>}</span>
<span id="cb69-28"><a href="#cb69-28"></a></span>
<span id="cb69-29"><a href="#cb69-29"></a><span class="kw">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb69-30"><a href="#cb69-30"></a>n&lt;-<span class="dv">20000</span></span>
<span id="cb69-31"><a href="#cb69-31"></a>b&lt;-<span class="dv">1000</span></span>
<span id="cb69-32"><a href="#cb69-32"></a>x0&lt;-<span class="kw">matrix</span>(<span class="dt">data=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="fl">0.7</span>,<span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.1</span>),<span class="dt">nrow =</span> <span class="dv">4</span>,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb69-33"><a href="#cb69-33"></a>X1&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,n)</span>
<span id="cb69-34"><a href="#cb69-34"></a>X2&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">4</span>,n)</span>
<span id="cb69-35"><a href="#cb69-35"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb69-36"><a href="#cb69-36"></a>  X1[i,]=<span class="kw">gibbs.chain</span>(n,x0[i,])[,<span class="dv">1</span>]</span>
<span id="cb69-37"><a href="#cb69-37"></a>  X2[i,]=<span class="kw">gibbs.chain</span>(n,x0[i,])[,<span class="dv">2</span>]</span>
<span id="cb69-38"><a href="#cb69-38"></a>}</span>
<span id="cb69-39"><a href="#cb69-39"></a></span>
<span id="cb69-40"><a href="#cb69-40"></a>psi1&lt;-<span class="kw">t</span>(<span class="kw">apply</span>(X1,<span class="dv">1</span>,cumsum))</span>
<span id="cb69-41"><a href="#cb69-41"></a>psi2&lt;-<span class="kw">t</span>(<span class="kw">apply</span>(X2,<span class="dv">1</span>,cumsum))</span>
<span id="cb69-42"><a href="#cb69-42"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi1)){</span>
<span id="cb69-43"><a href="#cb69-43"></a>psi1[i,] &lt;-<span class="st"> </span>psi1[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi1))</span>
<span id="cb69-44"><a href="#cb69-44"></a>psi2[i,] &lt;-<span class="st"> </span>psi2[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi2))</span>
<span id="cb69-45"><a href="#cb69-45"></a>}</span>
<span id="cb69-46"><a href="#cb69-46"></a></span>
<span id="cb69-47"><a href="#cb69-47"></a>rhat1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb69-48"><a href="#cb69-48"></a>rhat2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb69-49"><a href="#cb69-49"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb69-50"><a href="#cb69-50"></a>rhat1[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb69-51"><a href="#cb69-51"></a>rhat2[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb69-52"><a href="#cb69-52"></a>}</span>
<span id="cb69-53"><a href="#cb69-53"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb69-54"><a href="#cb69-54"></a><span class="kw">plot</span>(rhat1[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb69-55"><a href="#cb69-55"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb69-56"><a href="#cb69-56"></a><span class="kw">plot</span>(rhat2[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb69-57"><a href="#cb69-57"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="a-21016-2021-11-18" class="section level2">
<h2>A-21016-2021-11-18</h2>
</div>
<div id="qusetion-1" class="section level2">
<h2>Qusetion</h2>
<p>Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)<br />
Suppose <span class="math inline">\(T_1, . . . ,T_n\)</span> are i.i.d. samples drawn from the exponential distribution with expectation. Those values greater than are not observed due to right censorship, so that the observed values are <span class="math inline">\(Y_i = T_iI(Ti&lt;\tau)+\tau I(Ti&gt;\tau), i= 1, . . . , n.\)</span>Suppose<span class="math inline">\(\tau = 1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: 0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85<br />
Use the E-M algorithm to estimate, compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<p>11.3<br />
(1)</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>g&lt;-<span class="cf">function</span>(k,d){</span>
<span id="cb70-2"><a href="#cb70-2"></a>  <span class="kw">return</span>(</span>
<span id="cb70-3"><a href="#cb70-3"></a>    <span class="kw">exp</span>(<span class="kw">lgamma</span>(k<span class="op">+</span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>((d<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">+</span>d<span class="op">/</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span>))</span>
<span id="cb70-4"><a href="#cb70-4"></a>    )</span>
<span id="cb70-5"><a href="#cb70-5"></a>}</span>
<span id="cb70-6"><a href="#cb70-6"></a></span>
<span id="cb70-7"><a href="#cb70-7"></a></span>
<span id="cb70-8"><a href="#cb70-8"></a>kth&lt;-<span class="cf">function</span>(a,k){</span>
<span id="cb70-9"><a href="#cb70-9"></a>  d&lt;-<span class="kw">length</span>(a)</span>
<span id="cb70-10"><a href="#cb70-10"></a>  anorm&lt;-<span class="dv">0</span></span>
<span id="cb70-11"><a href="#cb70-11"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){</span>
<span id="cb70-12"><a href="#cb70-12"></a>    anorm&lt;-a[i]<span class="op">^</span><span class="dv">2</span><span class="op">+</span>anorm</span>
<span id="cb70-13"><a href="#cb70-13"></a>}</span>
<span id="cb70-14"><a href="#cb70-14"></a>  b=anorm<span class="op">^</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>((<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>k<span class="op">+</span><span class="dv">2</span>))</span>
<span id="cb70-15"><a href="#cb70-15"></a><span class="kw">return</span>((<span class="op">-</span><span class="dv">1</span>)<span class="op">^</span>k<span class="op">*</span>b<span class="op">*</span><span class="kw">g</span>(k,d)<span class="op">/</span>(<span class="kw">factorial</span>(k)<span class="op">*</span><span class="dv">2</span><span class="op">^</span>k))</span>
<span id="cb70-16"><a href="#cb70-16"></a>}</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>sumfun&lt;-<span class="cf">function</span>(a,k){</span>
<span id="cb71-2"><a href="#cb71-2"></a>  res&lt;-<span class="dv">0</span></span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(k<span class="op">+</span><span class="dv">1</span>)){</span>
<span id="cb71-4"><a href="#cb71-4"></a>    res&lt;-res<span class="op">+</span><span class="kw">kth</span>(a,i<span class="dv">-1</span>)</span>
<span id="cb71-5"><a href="#cb71-5"></a>  }</span>
<span id="cb71-6"><a href="#cb71-6"></a>  <span class="kw">return</span>(res)</span>
<span id="cb71-7"><a href="#cb71-7"></a>}</span></code></pre></div>
<p>(3)取<span class="math inline">\(a=(1,2)^T,k=10,100,100,d=2\)</span></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>a&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb72-2"><a href="#cb72-2"></a>k=<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">100</span>)</span>
<span id="cb72-3"><a href="#cb72-3"></a>funsum&lt;-<span class="kw">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb72-4"><a href="#cb72-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</span>
<span id="cb72-5"><a href="#cb72-5"></a>  funsum[i]=<span class="kw">sumfun</span>(a,k[i])</span>
<span id="cb72-6"><a href="#cb72-6"></a>}</span>
<span id="cb72-7"><a href="#cb72-7"></a>res&lt;-<span class="kw">data.frame</span>(k,funsum)</span>
<span id="cb72-8"><a href="#cb72-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(res)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">funsum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10</td>
<td align="right">1.532165</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">1.532164</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">1.532164</td>
</tr>
</tbody>
</table>
<p>11.5<br />
根据题意方程两侧分别为<span class="math inline">\(P(0&lt;t(k-1)&lt;c_{k-1})\)</span>和<span class="math inline">\(P(0&lt;t(k)&lt;c_k)\)</span></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>sa&lt;-<span class="cf">function</span>(a,k){</span>
<span id="cb73-2"><a href="#cb73-2"></a>  ck=<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb73-3"><a href="#cb73-3"></a>  res=<span class="dv">1</span><span class="op">/</span><span class="dv">2</span><span class="op">-</span><span class="kw">pt</span>(ck,k,<span class="dt">lower.tail =</span> F)</span>
<span id="cb73-4"><a href="#cb73-4"></a>  <span class="kw">return</span>(res)</span>
<span id="cb73-5"><a href="#cb73-5"></a>}</span>
<span id="cb73-6"><a href="#cb73-6"></a>f&lt;-<span class="cf">function</span>(a,k){</span>
<span id="cb73-7"><a href="#cb73-7"></a>  <span class="kw">return</span>(<span class="kw">sa</span>(a,k)<span class="op">-</span><span class="kw">sa</span>(a,k<span class="dv">-1</span>))</span>
<span id="cb73-8"><a href="#cb73-8"></a>}</span>
<span id="cb73-9"><a href="#cb73-9"></a></span>
<span id="cb73-10"><a href="#cb73-10"></a>k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb73-11"><a href="#cb73-11"></a>a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dt">by=</span><span class="fl">0.01</span>)</span>
<span id="cb73-12"><a href="#cb73-12"></a><span class="kw">plot</span>(a, <span class="kw">f</span>(a, k[<span class="dv">23</span>]), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="dv">1</span>, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">xlab=</span><span class="st">&quot;a&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;f(a|k)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;f(a) with different k&quot;</span>)</span>
<span id="cb73-13"><a href="#cb73-13"></a><span class="kw">lines</span>(a, <span class="kw">f</span>(a, k[<span class="dv">24</span>]), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">col=</span><span class="dv">2</span>)</span>
<span id="cb73-14"><a href="#cb73-14"></a><span class="kw">lines</span>(a, <span class="kw">f</span>(a, k[<span class="dv">25</span>]), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">lty=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="dv">3</span>)</span>
<span id="cb73-15"><a href="#cb73-15"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;k=100&quot;</span>, <span class="st">&quot;k=500&quot;</span>, <span class="st">&quot;k=1000&quot;</span>), <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dt">lty=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>solve &lt;-<span class="st"> </span><span class="cf">function</span>(k){</span>
<span id="cb74-2"><a href="#cb74-2"></a>  output =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">sa</span>(a,k)<span class="op">-</span><span class="kw">sa</span>(a,k<span class="dv">-1</span>)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)</span>
<span id="cb74-3"><a href="#cb74-3"></a>  output<span class="op">$</span>root</span>
<span id="cb74-4"><a href="#cb74-4"></a>}</span>
<span id="cb74-5"><a href="#cb74-5"></a></span>
<span id="cb74-6"><a href="#cb74-6"></a>root&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="kw">length</span>(k))</span>
<span id="cb74-7"><a href="#cb74-7"></a>root[<span class="dv">1</span>,]=k</span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</span>
<span id="cb74-9"><a href="#cb74-9"></a>  root[<span class="dv">2</span>,i]&lt;-<span class="kw">solve</span>(k[i])</span>
<span id="cb74-10"><a href="#cb74-10"></a>}</span>
<span id="cb74-11"><a href="#cb74-11"></a></span>
<span id="cb74-12"><a href="#cb74-12"></a><span class="kw">rownames</span>(root) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;A(k)&#39;</span>)</span>
<span id="cb74-13"><a href="#cb74-13"></a><span class="kw">print</span>(root)</span></code></pre></div>
<pre><code>##          [,1]     [,2]     [,3]    [,4]     [,5]     [,6]     [,7]      [,8]
## k    4.000000 5.000000 6.000000 7.00000 8.000000 9.000000 10.00000 11.000000
## A(k) 1.492103 1.533556 1.562744 1.58443 1.601185 1.614521  1.62539  1.634419
##           [,9]     [,10]    [,11]     [,12]     [,13]     [,14]     [,15]
## k    12.000000 13.000000 14.00000 15.000000 16.000000 17.000000 18.000000
## A(k)  1.642038  1.648554  1.65419  1.659114  1.663452  1.667303  1.670745
##         [,16]     [,17]     [,18]     [,19]    [,20]     [,21]     [,22]
## k    19.00000 20.000000 21.000000 22.000000 23.00000 24.000000 25.000000
## A(k)  1.67384  1.676637  1.679178  1.681496  1.68362  1.685572  1.687373
##           [,23]      [,24]       [,25]
## k    100.000000 500.000000 1000.000000
## A(k)   1.720608   1.729755    1.730907</code></pre>
<p>所得结果与11.4结果相同。</p>
<p>E-M algorithm</p>
<p>假设大于<span class="math inline">\(\tau\)</span>的观测数据为<span class="math inline">\(X=x_1,x_2,...,x_m\)</span>，<span class="math inline">\(Y=y_1,...,y_n\)</span>为小于和等于<span class="math inline">\(\tau\)</span>的观测数据。<br />
似然函数为 <span class="math display">\[(\frac{1}{\lambda})^ne^{-\frac{1}{\lambda}(\sum_{i=1}^mx_i+\sum_{j=1}^{n-m}y_j)},\lambda&gt;0,x_i,y_j&gt;0,i=1,..,m,j=1,...,n-m \]</span> 取对数得到 <span class="math display">\[l(\lambda|X,Y)=log((\frac{1}{\lambda})^ne^{-\frac{1}{\lambda}(\sum_{i=1}^mx_i+\sum_{j=1}^{n-m}y_j)})=-nlog\lambda-\frac{1}{\lambda}(\sum_{i=1}^mx_i+\sum_{j=1}^{n-m}y_j)\]</span> 对第(j-1)次迭代得到的<span class="math inline">\(\lambda^{j-1}\)</span> E步期望为： <span class="math display">\[
\begin{aligned}
Q(\lambda,\lambda^{(j-1)})&amp;=E_{X|\lambda^{(j-1)},Y}[l(\lambda|X,Y)]\\
&amp;=-nlog\lambda-\frac{1}{\lambda}(\sum_{i=1}^mE(X_i|\lambda^{(j-1)},Y)+\sum_{j=1}^{n-m}y_j)
\end{aligned}
\]</span> 其中 <span class="math display">\[E(X_i|\lambda^{(j-1)},Y)=\int_{\tau}^\infty x\frac{1}{\lambda^{(j-1)}}e^{-\frac{1}{\lambda^{(j-1)}}(x-\tau)}dx=(\tau+\lambda^{(j-1)})\]</span> 根据题意,<span class="math inline">\(n=10,m=3,\tau=1,\sum_{j=1}^{n-m}y_j=3.75\)</span> <span class="math display">\[Q(\lambda,\lambda^{(j-1)})=-10log\lambda-\frac{1}{\lambda}(3(1+\lambda^{(j-1)})+3.75)\]</span> M步求最大值： <span class="math display">\[\lambda^{(j)}=argmaxQ(\lambda,\lambda^{(j-1)})=\frac{3(1+\lambda^{(j-1)})+3.75)}{10}\]</span> 对上述两步循环迭代直至收敛。</p>
<p>MLE估计： <span class="math display">\[\hat{\lambda}=\frac{\sum_{i=1}^mx_i+\sum_{j=1}^{n-m}y_j}{r}=\frac{3+3.75}{7}\approx0.9643\]</span></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>em&lt;-<span class="cf">function</span>(lambda0){</span>
<span id="cb76-2"><a href="#cb76-2"></a>  e&lt;-<span class="fl">0.0001</span></span>
<span id="cb76-3"><a href="#cb76-3"></a>  n=<span class="dv">10000</span></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb76-5"><a href="#cb76-5"></a>  lambda=(<span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>lambda0)<span class="op">+</span><span class="fl">3.75</span>)<span class="op">/</span><span class="dv">10</span></span>
<span id="cb76-6"><a href="#cb76-6"></a>  <span class="cf">if</span>(lambda<span class="op">-</span>lambda0<span class="op">&gt;</span>e)</span>
<span id="cb76-7"><a href="#cb76-7"></a>    lambda0=lambda</span>
<span id="cb76-8"><a href="#cb76-8"></a>  <span class="cf">else</span></span>
<span id="cb76-9"><a href="#cb76-9"></a>    <span class="cf">break</span></span>
<span id="cb76-10"><a href="#cb76-10"></a> }</span>
<span id="cb76-11"><a href="#cb76-11"></a><span class="kw">return</span>(lambda)</span>
<span id="cb76-12"><a href="#cb76-12"></a>}</span>
<span id="cb76-13"><a href="#cb76-13"></a>res&lt;-<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb76-14"><a href="#cb76-14"></a>  lambda0=<span class="kw">c</span>(<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb76-15"><a href="#cb76-15"></a>  res[<span class="dv">1</span>,]=lambda0</span>
<span id="cb76-16"><a href="#cb76-16"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</span>
<span id="cb76-17"><a href="#cb76-17"></a>res[<span class="dv">2</span>,i]=<span class="kw">em</span>(lambda0[i])</span>
<span id="cb76-18"><a href="#cb76-18"></a>}</span>
<span id="cb76-19"><a href="#cb76-19"></a>  <span class="kw">rownames</span>(res)=<span class="kw">c</span>(<span class="st">&#39;lambda0&#39;</span>,<span class="st">&#39;lambdahat&#39;</span>)</span>
<span id="cb76-20"><a href="#cb76-20"></a>  <span class="kw">print</span>(res)</span></code></pre></div>
<pre><code>##                [,1]      [,2]  [,3]  [,4]
## lambda0   0.2000000 0.5000000 1.000 2.000
## lambdahat 0.9642707 0.9642553 0.975 1.275</code></pre>
<p>根据结果可得，当初值选择小于等于1时，EM算法所得到的结果与MLE估计结果相似。</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
